{"version": 2, "width": 100, "height": 26, "timestamp": 1589148364, "idle_time_limit": 3.0, "env": {"SHELL": "/bin/bash", "TERM": "xterm-256color"}}
[0.003093, "o", "\u001b[?1049h\u001b[22;0;0t\u001b[?1h\u001b=\u001b[H\u001b[2J\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1002l\u001b[?1006l\u001b[?1005l\u001b[c\u001b(B\u001b[m\u001b[?12;25h\u001b[?12l\u001b[?25h\u001b[?1003l\u001b[?1006l\u001b[?2004l\u001b[1;1H\u001b[1;26r\u001b]112\u0007\u001b[6;1H\u001b[?1006h\u001b[?1000h"]
[0.003519, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitla"]
[0.003539, "o", "b-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  186,1         89%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash- 1:vi*                                                  \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[6;1H\u001b[?12l\u001b[?25h\u001b(B\u001b[m\u001b[?12;25h\u001b[?12l\u001b[?25h\u001b[?1003l\u001b[?1006l\u001b[?2004l\u001b[1;1H\u001b[1;26r\u001b[6;1H\u001b[?1006h\u001b[?1000h"]
[0.003615, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitla"]
[0.003636, "o", "b-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  186,1         89%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash- 1:vi*                                                  \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[6;1H\u001b[?12l\u001b[?25h"]
[2.323807, "o", "\u001b[?25l\u001b[32m\u001b[17d───────────────────────────────────────────────────\u001b[39m─────────────────────────────────────────────────\u001b[1;1H\u001b(B\u001b[mStatus: Downloaded newer image for sudobmitch/demo:ubuntu                                          \u001b[K\r\ndocker.io/sudobmitch/demo:ubuntu\u001b[K\r\n$ docker-compose -f docker-compose.demo6.yml exec --index=3 builder sh                             \u001b[K\r\n/ # docker image ls\u001b[K\r\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE               \u001b[K\r\n/ # docker image pull sudobmitch/demo:ubuntu\u001b[K\r\nubuntu: Pulling from sudobmitch/demo\u001b[K\r\nd51af753c3d3: Pull complete\u001b[K\r\nfc878cd0a91c: Pull complete\u001b[K\r\n6154df8ff988: Pull complete\u001b[K\r\nfee5db0ff82f: Pull complete\u001b[K\r\nDigest: sha256:5747316366b8cc9e3021cd7286f42b2d6d81e3d743e2ab571f55bcd5df788cc8                    \u001b"]
[2.323919, "o", "[K\r\nStatus: Downloaded newer image for sudobmitch/demo:ubuntu                                          \u001b[K\r\ndocker.io/sudobmitch/demo:ubuntu\u001b[K\r\n/ # exit\u001b[K\r\n$\u001b[K\u001b[18;1Hd51af753c3d3: Pull complete\u001b[K\r\nfc878cd0a91c: Pull complete\u001b[K\r\n6154df8ff988: Pull complete\u001b[K\r\nfee5db0ff82f: Pull complete\u001b[K\r\nDigest: sha256:5747316366b8cc9e3021cd7286f42b2d6d81e3d743e2ab571f55bcd5df788cc8                    \u001b[K\r\nStatus: Downloaded newer image for sudobmitch/demo:ubuntu                                          \u001b[K\r\ndocker.io/sudobmitch/demo:ubuntu\u001b[K\r\n$\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash* 1:vi-                                                  \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[16;3H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[4.099533, "o", "\u001b[?25l\u001b[HCreating example_builder_3 ... \u001b[32mdone\u001b[39m\u001b[K\r\n$ docker-compose -f docker-compose.demo6.yml exec --index=1 builder docker image pull sudobmitch/demo:ubuntu\u001b[K\r\nubuntu: Pulling from sudobmitch/demo\u001b[K\r\nd51af753c3d3: Pull complete\u001b[K\r\nfc878cd0a91c: Pull complete\u001b[K\r\n6154df8ff988: Pull complete\u001b[K\r\nfee5db0ff82f: Pull complete\u001b[K\r\nDigest: sha256:5747316366b8cc9e3021cd7286f42b2d6d81e3d743e2ab571f55bcd5df788cc8                    \u001b[K\r\nStatus: Downloaded newer image for sudobmitch/demo:ubuntu                                          \u001b[K\r\ndocker.io/sudobmitch/demo:ubuntu\u001b[K\r\n$ docker-compose -f docker-compose.demo6.yml exec --index=3 builder sh                             \u001b[K\r\n/ # docker image ls\u001b[K\r\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE               \u001b[K\r\n/ # docker image pull sudobmitch/demo:ubuntu\u001b[K\r\nubuntu: Pulling from sudobmitch/demo\u001b[K\r\nd51af753c3d3: Pull complete\u001b[K\r\nfc878cd0a91c: Pull complete\u001b[K\r\n6154df8ff988: Pull complete\u001b[K\r\nfee5db0ff82f: Pull c"]
[4.099675, "o", "omplete\u001b[K\r\nDigest: sha256:5747316366b8cc9e3021cd7286f42b2d6d81e3d743e2ab571f55bcd5df788cc8                    \u001b[K\r\nStatus: Downloaded newer image for sudobmitch/demo:ubuntu                                          \u001b[K\r\ndocker.io/sudobmitch/demo:ubuntu\u001b[K\r\n/ # exit\u001b[K\r\n$\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h"]
[4.100051, "o", "\r\u001b[K$ "]
[4.480971, "o", "m"]
[4.618087, "o", "o"]
[4.680351, "o", "r"]
[4.745659, "o", "e"]
[4.905644, "o", " "]
[5.770042, "o", "d"]
[8.296889, "o", "\u0007"]
[8.801849, "o", "\b\u001b[K"]
[9.557554, "o", "\u0007"]
[9.693236, "o", "\u001b[1;25r\u001b[4S\u001b[22dca-key.pem                docker-compose.demo8.yml  reg.csr\r\nca.pem                    .env                      reg.ext\r\nca.srl                    .gitignore                reg-key.pem\u001b[1;26r\u001b[25;1H\u001b[1;25r\u001b[4S\u001b[21ddc.builder.yml            make-certs.demo5.sh       reg.pem\r\ndc.reg-cache.yml          make-certs.demo7.sh       setup-certs.sh\r\ndocker-compose.demo6.yml  make-certs.demo8.sh       \r\ndocker-compose.demo7.yml  mirror.sh                 \r\n$ more "]
[9.693576, "o", "\u001b[1;26r\u001b[25;8H"]
[10.33795, "o", "m"]
[10.401777, "o", "a"]
[10.546056, "o", "k"]
[10.67219, "o", "e-certs.demo\u0007"]
[14.890005, "o", "7"]
[15.125067, "o", ".sh "]
[15.60971, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[15.613049, "o", "\u001b[1;25r\u001b[5S\u001b[20d#!/bin/sh\u001b[22;1H[ -f ca-key.pem ] || openssl genrsa -out ca-key.pem 4096\r\nopenssl req -new -x509 -days 365 -subj \"/CN=Local CA\" -key ca-key.pem -sha256 -out ca.pem\r\n[ -f reg-key.pem ] || openssl genrsa -out reg-key.pem 4096\u001b[1;26r\u001b[25;1H"]
[15.613412, "o", "\u001b[1;25r\u001b[7S\u001b[18d[ -f reg.csr ] || openssl req -new -subj \"/CN=Registry\" -key reg-key.pem -out reg.csr\r\necho \"subjectAltName = DNS:hub-cache,DNS:gitlab-cache\" >reg.ext\r\nopenssl x509 -req -days 365 -in reg.csr -extfile reg.ext -CA ca.pem -CAkey ca-key.pem -CAcreateseria\u001b[21;1Hl -out reg.pem\u001b[1;26r\u001b[25;1H"]
[15.613745, "o", "$ "]
[17.330176, "o", "."]
[17.425833, "o", "/"]
[17.881735, "o", "m"]
[17.96189, "o", "a"]
[18.081636, "o", "k"]
[18.234275, "o", "e-certs.demo\u0007"]
[19.154307, "o", "7"]
[19.305627, "o", ".sh "]
[22.643621, "o", "\u001b[?25l\u001b[HStatus: Downloaded newer image for sudobmitch/demo:ubuntu                                    \u001b[30m\u001b[43m[0/361]\u001b[2;1H\u001b[39m\u001b[49mdocker.io/sudobmitch/demo:ubuntu\u001b[K\r\n/ # exit\u001b[K\r\n$ more\u001b[K\r\nca-key.pem                docker-compose.demo8.yml  reg.csr                                        \u001b[K\r\nca.pem                    .env                      reg.ext                                        \u001b[K\r\nca.srl                    .gitignore                reg-key.pem                                    \u001b[K\r\ndc.builder.yml            make-certs.demo5.sh       reg.pem                                        \u001b[K\r\ndc.reg-cache.yml          make-certs.demo7.sh       setup-certs.sh                                 \u001b[K\r\ndocker-compose.demo6.yml  make-certs.demo8.sh\u001b[K\r\ndocker-compose.demo7.yml  mirror.sh\u001b[K\r\n$ more make-certs.demo7.sh\u001b[K\r\n#!/bin/sh\u001b[K\r\n\u001b[K\r\n[ -f ca-key.pem ] || openssl genrsa -out ca-key.pem 4096                                           \u001b[K\r\nopenssl req -new -x509 -days 365 -subj \"/CN=Local CA\" -key ca-ke"]
[22.643943, "o", "y.pem -sha256 -out ca.pem          \u001b[K\r\n[ -f reg-key.pem ] || openssl genrsa -out reg-key.pem 4096                                         \u001b[K\r\n[ -f reg.csr ] || openssl req -new -subj \"/CN=Registry\" -key reg-key.pem -out reg.csr              \u001b[K\r\necho \"subjectAltName = DNS:hub-cache,DNS:gitlab-cache\" >reg.ext                                    \u001b[K\r\nopenssl x509 -req -days 365 -in reg.csr -extfile reg.ext -CA ca.pem -CAkey ca-key.pem -CAcreateseria\u001b[21;1Hl -out reg.pem\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n$ ./make-certs.demo7.sh\u001b[K\u001b[C\u001b[?12l\u001b[?25h"]
[22.645215, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:[tmux]*Z 1:vi-                                               \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[25;25H\u001b[?12l\u001b[?25h"]
[23.16224, "o", "\u001b[24;1H"]
[23.34598, "o", "\u001b[A"]
[23.530189, "o", "\u001b[A"]
[23.70728, "o", "\u001b[21;15H"]
[23.890115, "o", "\u001b[20;100H$\u001b[20;100H"]
[24.106266, "o", "\u001b[19;64H"]
[24.434288, "o", "\b"]
[24.935135, "o", "\b"]
[24.965273, "o", "\b"]
[24.996358, "o", "\b"]
[25.026649, "o", "\b"]
[25.053868, "o", "\b"]
[25.087393, "o", "\b"]
[25.117523, "o", "\b"]
[25.144991, "o", "\b"]
[25.458262, "o", "\b"]
[25.98641, "o", "\b"]
[26.266618, "o", "\u001b[30m\u001b[43me\u001b[20;100H\u001b[39m\u001b[49ma\u001b[19;53H"]
[26.42642, "o", "\b\u001b[30m\u001b[43mhe\b\b\u001b(B\u001b[m"]
[26.926274, "o", "\b\u001b[30m\u001b[43mche\u001b[3D\u001b(B\u001b[m"]
[26.952541, "o", "\b\u001b[30m\u001b[43mache\u001b[4D\u001b(B\u001b[m"]
[26.987552, "o", "\b\u001b[30m\u001b[43mcache\u001b[5D\u001b(B\u001b[m"]
[27.017803, "o", "\b\u001b[30m\u001b[43m-cache\u001b[6D\u001b(B\u001b[m"]
[27.045788, "o", "\b\u001b[30m\u001b[43mb-cache\u001b[7D\u001b(B\u001b[m"]
[27.076373, "o", "\b\u001b[30m\u001b[43mab-cache\u001b[8D\u001b(B\u001b[m"]
[27.110625, "o", "\b\u001b[30m\u001b[43mlab-cache\u001b[9D\u001b(B\u001b[m"]
[27.139231, "o", "\b\u001b[30m\u001b[43mtlab-cache\u001b[10D\u001b(B\u001b[m"]
[27.170557, "o", "\b\u001b[30m\u001b[43mitlab-cache\u001b[11D\u001b(B\u001b[m"]
[27.199513, "o", "\b\u001b[30m\u001b[43mgitlab-cache\u001b[12D\u001b(B\u001b[m"]
[27.229981, "o", "\b\u001b[30m\u001b[43m:gitlab-cache\u001b[13D\u001b(B\u001b[m"]
[27.259825, "o", "\b\u001b[30m\u001b[43mS:gitlab-cache\u001b[14D\u001b(B\u001b[m"]
[27.290515, "o", "\b\u001b[30m\u001b[43mNS:gitlab-cache\u001b[15D\u001b(B\u001b[m"]
[28.299884, "o", "\u001b[?25l\u001b[HStatus: Downloaded newer image for sudobmitch/demo:ubuntu                                          \u001b[K\r\ndocker.io/sudobmitch/demo:ubuntu\u001b[K\r\n/ # exit\u001b[K\r\n$ more\u001b[K\r\nca-key.pem                docker-compose.demo8.yml  reg.csr                                        \u001b[K\r\nca.pem                    .env                      reg.ext                                        \u001b[K\r\nca.srl                    .gitignore                reg-key.pem                                    \u001b[K\r\ndc.builder.yml            make-certs.demo5.sh       reg.pem                                        \u001b[K\r\ndc.reg-cache.yml          make-certs.demo7.sh       setup-certs.sh                                 \u001b[K\r\ndocker-compose.demo6.yml  make-certs.demo8.sh                                                      \u001b[K\r\ndocker-compose.demo7.yml  mirror.sh                                                                \u001b[K\r\n$ more make-certs.demo7.sh\u001b[K\r\n#!/bin/sh\u001b[K\r\n\u001b[K\r\n[ -f ca-key.pem ] || openssl genrsa -out ca-key.pem 4096                "]
[28.300215, "o", "                           \u001b[K\r\nopenssl req -new -x509 -days 365 -subj \"/CN=Local CA\" -key ca-key.pem -sha256 -out ca.pem          \u001b[K\r\n[ -f reg-key.pem ] || openssl genrsa -out reg-key.pem 4096                                         \u001b[K\r\n[ -f reg.csr ] || openssl req -new -subj \"/CN=Registry\" -key reg-key.pem -out reg.csr              \u001b[K\r\necho \"subjectAltName = DNS:hub-cache,DNS:gitlab-cache\" >reg.ext                                    \u001b[K\r\nopenssl x509 -req -days 365 -in reg.csr -extfile reg.ext -CA ca.pem -CAkey ca-key.pem -CAcreateseria\u001b[21;1Hl -out reg.pem\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n$ ./make-certs.demo7.sh\u001b[K\u001b[C\u001b[?12l\u001b[?25h"]
[28.301531, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[25;25H\u001b[?12l\u001b[?25h"]
[28.826382, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[28.867086, "o", "\u001b[1;25r\u001b[2S\u001b[23dSignature ok\r\nsubject=CN = Registry\u001b[1;26r\u001b[25;1H"]
[28.867258, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[AGetting CA Private Key\u001b[1;26r\u001b[25;1H"]
[28.880058, "o", "$ "]
[30.395574, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitla"]
[30.395698, "o", "b-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  186,1         89%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash-Z 1:vi*                                                 \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[6;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[31.394736, "o", "\u001b[25;85H7\u001b[7;1H"]
[31.594321, "o", "\u001b[25;85H8\u001b[8;1H"]
[31.770331, "o", "\u001b[25;85H9\u001b[9;1H"]
[31.986227, "o", "\u001b[25;84H90\u001b[10;1H"]
[32.434472, "o", "\u001b[25;84H89\u001b[9;1H"]
[33.634735, "o", "\u001b[25;84H90\u001b[10;1H"]
[34.637491, "o", "\u001b[?25l\u001b[H                                                                                               \u001b[30m\u001b[43m[0/0]\u001b[2;1H\u001b[39m\u001b[49m## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian     "]
[34.638227, "o", "                                 \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitlab-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  190,1         89%\u001b[K\u001b[10;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[34.639764, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:bash-Z 1:[tmux]*                                             \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[10;1H\u001b[?12l\u001b[?25h"]
[35.027044, "o", "\u001b[30m\u001b[43md\r\u001b(B\u001b[m"]
[35.258942, "o", "\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo7.yml up -d                                                    \u001b[11;1Hd\r\u001b(B\u001b[m"]
[35.362532, "o", "\u001b[A\u001b[30m\u001b[43md\u001b[39m\u001b[49mocker-compose -f docker-compose.demo7.yml up -d                                                    \u001b[11;1Hd\u001b[10;1H\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo7.yml up -d \b\u001b(B\u001b[m"]
[35.634412, "o", "\r\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo7.yml up -d\u001b[39m\u001b[49m \b\b"]
[36.369861, "o", "\u001b]52;;ZG9ja2VyLWNvbXBvc2UgLWYgZG9ja2VyLWNvbXBvc2UuZGVtbzcueW1sIHVwIC1k\u0007\r\u001b[?1006h\u001b[?1000h"]
[36.372282, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitla"]
[36.372598, "o", "b-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  190,1         89%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash-Z 1:vi*                                                 \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[10;1H\u001b[?12l\u001b[?25h"]
[36.995369, "o", "\u001b[?25l\u001b[Hca-key.pem                docker-compose.demo8.yml  reg.csr                                        \u001b[K\r\nca.pem                    .env                      reg.ext                                        \u001b[K\r\nca.srl                    .gitignore                reg-key.pem                                    \u001b[K\r\ndc.builder.yml            make-certs.demo5.sh       reg.pem                                        \u001b[K\r\ndc.reg-cache.yml          make-certs.demo7.sh       setup-certs.sh                                 \u001b[K\r\ndocker-compose.demo6.yml  make-certs.demo8.sh                                                      \u001b[K\r\ndocker-compose.demo7.yml  mirror.sh                                                                \u001b[K\r\n$ more make-certs.demo7.sh\u001b[K\r\n#!/bin/sh\u001b[K\r\n\u001b[K\r\n[ -f ca-key.pem ] || openssl genrsa -out ca-key.pem 4096                                           \u001b[K\r\nopenssl req -new -x509 -days 365 -subj \"/CN=Local CA\" -key ca-key.pem -sha256 -out ca.pem          \u001b[K\r\n[ -f reg-key.pem ] || openssl"]
[36.995766, "o", " genrsa -out reg-key.pem 4096                                         \u001b[K\r\n[ -f reg.csr ] || openssl req -new -subj \"/CN=Registry\" -key reg-key.pem -out reg.csr              \u001b[K\r\necho \"subjectAltName = DNS:hub-cache,DNS:gitlab-cache\" >reg.ext                                    \u001b[K\r\nopenssl x509 -req -days 365 -in reg.csr -extfile reg.ext -CA ca.pem -CAkey ca-key.pem -CAcreateseria\u001b[17;1Hl -out reg.pem\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n$ ./make-certs.demo7.sh\u001b[K\r\nSignature ok\u001b[K\r\nsubject=CN = Registry\u001b[K\r\nGetting CA Private Key\u001b[K\r\n$\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[38.002059, "o", "m"]
[38.097819, "o", "o"]
[38.1378, "o", "r"]
[38.201769, "o", "e"]
[38.329744, "o", " "]
[38.505657, "o", "d"]
[38.593929, "o", "o"]
[38.721837, "o", "c"]
[38.793689, "o", "k"]
[39.011491, "o", "er-compose.demo\u0007"]
[39.946127, "o", "7"]
[40.086711, "o", ".yml "]
[40.602382, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[40.605867, "o", "\u001b[1;25r\u001b[16S\u001b[9dversion: '3.7'\u001b[11;1Hnetworks:\r\n  cache:\r\n    name: cache\r\n    external: true\u001b[16;1Hvolumes:\r\n  hub-cache:\r\n    name: hub-cache\r\n  gitlab-cache:\r\n    name: gitlab-cache\u001b[22;1Hservices:\r\n  builder:\r\n    image: docker:dind\u001b[1;26r\u001b[25;1H\u001b[1;25r\u001b[8S\u001b[17d    command: [\"--registry-mirror\", \"https://hub-cache:5000\", \"--debug\"]\r\n    privileged: true\r\n    restart: unless-stopped\r\n    env_file: .env\r\n    networks:\r\n    - cache\r\n    volumes:\r\n    - type: bind"]
[40.605972, "o", "\u001b[1;26r\u001b[25;1H\u001b[7m--More--(21%)\u001b(B\u001b[m"]
[44.722525, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:more*Z 1:vi-                                                 \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[25;14H\u001b[?12l\u001b[?25h"]
[45.11565, "o", "\u001b[?25l\u001b[Hversion: '3.7'                                                                               \u001b[30m\u001b[43m[0/390]\u001b[39m\u001b[49m\u001b[2;1H\u001b[K\r\nnetworks:\u001b[K\r\n  cache:\u001b[K\r\n    name: cache\u001b[K\r\n    external: true\u001b[K\r\n\u001b[K\r\nvolumes:\u001b[K\r\n  hub-cache:\u001b[K\r\n    name: hub-cache\u001b[K\r\n  gitlab-cache:\u001b[K\r\n    name: gitlab-cache\u001b[K\r\n\u001b[K\r\nservices:\u001b[K\r\n  builder:\u001b[K\r\n    image: docker:dind\u001b[K\r\n    command: [\"--registry-mirror\", \"https://hub-cache:5000\", \"--debug\"]                            \u001b[K\r\n    privileged: true\u001b[K\r\n    restart: unless-stopped\u001b[K\r\n    env_file: .env\u001b[K\r\n    networks:\u001b[K\r\n    - cache\u001b[K\r\n    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n\u001b[7m--More--(21%)\u001b(B\u001b[m\u001b[K\u001b[?12l\u001b[?25h"]
[45.116941, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:[tmux]*Z 1:vi-                                               \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[25;14H\u001b[?12l\u001b[?25h"]
[45.458485, "o", "\u001b[24;17H"]
[45.958328, "o", "\u001b[23;13H"]
[45.988764, "o", "\u001b[22;12H"]
[46.017917, "o", "\u001b[21;14H"]
[46.047041, "o", "\u001b[20;19H"]
[46.076664, "o", "\u001b[19;28H"]
[46.109863, "o", "\u001b[18;21H"]
[46.137959, "o", "\u001b[17;72H"]
[46.167823, "o", "\u001b[16;23H"]
[46.198368, "o", "\u001b[15;11H"]
[46.228967, "o", "\u001b[14;10H"]
[46.602406, "o", "\u001b[13;1H"]
[46.802317, "o", "\u001b[12;23H"]
[47.138666, "o", "\u001b[30m\u001b[43m \b\u001b(B\u001b[m"]
[47.306638, "o", "\u001b[11;1H\u001b[30m\u001b[43m  gitlab-cache:                                                                                     \u001b[12;1H    name: gitlab-cache \u001b[11;1H\u001b[39m\u001b[49m  gitlab-cache:\u001b[30m\u001b[43m                                                                                     \u001b[11;16H\u001b(B\u001b[m"]
[47.49836, "o", "\u001b[10;1H\u001b[30m\u001b[43m    name: hub-cache                                                                                 \u001b[11;1H  gitlab-cache:                                                                                     \u001b[10;1H\u001b[39m\u001b[49m    name: hub-cache\u001b[30m\u001b[43m                                                                                 \u001b[10;20H\u001b(B\u001b[m"]
[48.051071, "o", "\r\u001b[30m\u001b[43m    name: hub-cache                                                                                 \u001b[10;1H\u001b[39m\u001b[49m    name: hub-cache                                                                                 \u001b[11;1H\u001b[30m\u001b[43m  gitlab-cache:                                                                                     \u001b[11;1H\u001b(B\u001b[m"]
[49.304481, "o", "\u001b[?25l\u001b[Hversion: '3.7'\u001b[K\r\n\u001b[K\r\nnetworks:\u001b[K\r\n  cache:\u001b[K\r\n    name: cache\u001b[K\r\n    external: true\u001b[K\r\n\u001b[K\r\nvolumes:\u001b[K\r\n  hub-cache:\u001b[K\r\n    name: hub-cache\u001b[K\r\n  gitlab-cache:\u001b[K\r\n    name: gitlab-cache\u001b[K\r\n\u001b[K\r\nservices:\u001b[K\r\n  builder:\u001b[K\r\n    image: docker:dind\u001b[K\r\n    command: [\"--registry-mirror\", \"https://hub-cache:5000\", \"--debug\"]                            \u001b[K\r\n    privileged: true\u001b[K\r\n    restart: unless-stopped\u001b[K\r\n    env_file: .env\u001b[K\r\n    networks:\u001b[K\r\n    - cache\u001b[K\r\n    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n\u001b[7m--More--(21%)\u001b(B\u001b[m\u001b[K\u001b[?12l\u001b[?25h"]
[49.305207, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:more*Z 1:vi-                                                 \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[25;14H\u001b[?12l\u001b[?25h"]
[50.9941, "o", "\u001b[1;25r\u001b[8S\u001b[17d      source: ./ca.pem\r\n      target: /etc/docker/certs.d/hub-cache:5000/ca.crt\r\n      read_only: true\r\n    - type: bind\r\n      source: ./ca.pem\r\n      target: /etc/docker/certs.d/gitlab-cache:5000/ca.crt\r\n      read_only: true\u001b[1;26r\u001b[25;1H"]
[50.994457, "o", "\u001b[1;25r\u001b[16S\u001b[9d  hub-cache:\r\n    image: registry:2\r\n    restart: unless-stopped\r\n    env_file: .env\r\n    environment:\r\n      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry\r\n      REGISTRY_PROXY_REMOTEURL: https://registry-1.docker.io\r\n      REGISTRY_PROXY_USERNAME: $DOCKER_USER\r\n      REGISTRY_PROXY_PASSWORD: $DOCKER_TOKEN\r\n      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem\r\n      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem\r\n    networks:\r\n    - cache\r\n    volumes:\r\n    - type: bind\r\n      source: .\r\n\u001b[7m--More--(60%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[53.987787, "o", "\u001b[?25l\u001b[H      source: ./ca.pem                                                                       \u001b[30m\u001b[43m[0/414]\u001b[2;1H\u001b[39m\u001b[49m      target: /etc/docker/certs.d/hub-cache:5000/ca.crt                                            \u001b[K\r\n      read_only: true\u001b[K\r\n    - type: bind\u001b[K\r\n      source: ./ca.pem\u001b[K\r\n      target: /etc/docker/certs.d/gitlab-cache:5000/ca.crt                                         \u001b[K\r\n      read_only: true\u001b[K\r\n\u001b[K\r\n  hub-cache:\u001b[K\r\n    image: registry:2\u001b[K\r\n    restart: unless-stopped\u001b[K\r\n    env_file: .env\u001b[K\r\n    environment:\u001b[K\r\n      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry                                 \u001b[K\r\n      REGISTRY_PROXY_REMOTEURL: https://registry-1.docker.io                                       \u001b[K\r\n      REGISTRY_PROXY_USERNAME: $DOCKER_USER\u001b[K\r\n      REGISTRY_PROXY_PASSWORD: $DOCKER_TOKEN\u001b[K\r\n      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem\u001b[K\r\n      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem\u001b[K\r\n    networks:\u001b[K\r\n    - cache\u001b[K\r\n    volumes:"]
[53.98793, "o", "\u001b[K\r\n    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n\u001b[7m--More--(60%)\u001b(B\u001b[m\u001b[K\u001b[?12l\u001b[?25h"]
[53.989251, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:[tmux]*Z 1:vi-                                               \"bmitch-t490\" 18:06 10-May-20\u001b(B\u001b[m\u001b[25;14H\u001b[?12l\u001b[?25h"]
[54.446513, "o", "\u001b[24;16H"]
[54.950221, "o", "\u001b[23;17H"]
[54.980576, "o", "\u001b[22;13H"]
[55.01129, "o", "\u001b[21;12H"]
[55.041739, "o", "\u001b[20;14H"]
[55.068397, "o", "\u001b[19;47H"]
[55.099452, "o", "\u001b[18;51H"]
[55.130587, "o", "\u001b[17;45H"]
[55.161185, "o", "\u001b[16;44H"]
[55.192114, "o", "\u001b[15;61H"]
[55.222659, "o", "\u001b[14;67H"]
[55.253361, "o", "\u001b[13;17H"]
[55.28244, "o", "\u001b[12;19H"]
[55.313561, "o", "\u001b[11;28H"]
[55.344682, "o", "\u001b[10;22H"]
[55.374485, "o", "\u001b[9;13H"]
[55.408731, "o", "\u001b[8;1H"]
[55.43742, "o", "\u001b[7;22H"]
[56.018015, "o", "\u001b[30m\u001b[43m \u001b[?25l\u001b[26;1H\u001b[42m[preso] 0:[tmux]*Z 1:vi-                                               \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[7;22H\u001b[?12l\u001b[?25h"]
[56.201969, "o", "\u001b[6;1H\u001b[30m\u001b[43m      target: /etc/docker/certs.d/gitlab-cache:5000/ca.crt                                          \u001b[7;1H      read_only: true \u001b[6;1H\u001b[39m\u001b[49m      target: /etc/docker/certs.d/gitlab-cache:5000/ca.crt\u001b[30m\u001b[43m                                          \u001b[6;59H\u001b(B\u001b[m"]
[56.418089, "o", "\u001b[5;1H\u001b[30m\u001b[43m      source: ./ca.pem                                                                              \u001b[6;1H      target: /etc/docker/certs.d/gitlab-cache:5000/ca.crt                                          \u001b[5;1H\u001b[39m\u001b[49m      source: ./ca.pem\u001b[30m\u001b[43m                                                                              \u001b[5;23H\u001b(B\u001b[m"]
[56.594164, "o", "\u001b[4;1H\u001b[30m\u001b[43m    - type: bind                                                                                    \u001b[5;1H      source: ./ca.pem                                                                              \u001b[4;1H\u001b[39m\u001b[49m    - type: bind\u001b[30m\u001b[43m                                                                                    \u001b[4;17H\u001b(B\u001b[m"]
[56.769739, "o", "\u001b[3;1H\u001b[30m\u001b[43m      read_only: true                                                                               \u001b[4;1H    - type: bind                                                                                    \u001b[3;1H\u001b[39m\u001b[49m      read_only: true\u001b[30m\u001b[43m                                                                               \u001b[3;22H\u001b(B\u001b[m"]
[56.986114, "o", "\r\u001b[30m\u001b[43m      read_only: true                                                                               \u001b[3;1H\u001b[39m\u001b[49m      read_only: true                                                                               \u001b[4;1H\u001b[30m\u001b[43m    - type: bind                                                                                    \u001b[4;1H\u001b(B\u001b[m"]
[59.747569, "o", "\u001b[?25l\u001b[H      source: ./ca.pem\u001b[K\r\n      target: /etc/docker/certs.d/hub-cache:5000/ca.crt                                            \u001b[K\r\n      read_only: true\u001b[K\r\n    - type: bind\u001b[K\r\n      source: ./ca.pem\u001b[K\r\n      target: /etc/docker/certs.d/gitlab-cache:5000/ca.crt                                         \u001b[K\r\n      read_only: true\u001b[K\r\n\u001b[K\r\n  hub-cache:\u001b[K\r\n    image: registry:2\u001b[K\r\n    restart: unless-stopped\u001b[K\r\n    env_file: .env\u001b[K\r\n    environment:\u001b[K\r\n      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry                                 \u001b[K\r\n      REGISTRY_PROXY_REMOTEURL: https://registry-1.docker.io                                       \u001b[K\r\n      REGISTRY_PROXY_USERNAME: $DOCKER_USER\u001b[K\r\n      REGISTRY_PROXY_PASSWORD: $DOCKER_TOKEN\u001b[K\r\n      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem                                                 \u001b[K\r\n      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem\u001b[K\r\n    networks:\u001b[K\r\n    - cache\u001b[K\r\n    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n\u001b[7m"]
[59.747928, "o", "--More--(60%)\u001b(B\u001b[m\u001b[K\u001b[?12l\u001b[?25h"]
[59.748873, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:more*Z 1:vi-                                                 \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[25;14H\u001b[?12l\u001b[?25h"]
[60.634683, "o", "\u001b[1;25r\u001b[14S\u001b[11d      target: /host\r\n      read_only: true\r\n    - type: volume\r\n      source: hub-cache\r\n      target: /var/lib/registry\u001b[17;1H  gitlab-cache:\r\n    image: registry:2\r\n    restart: unless-stopped\r\n    environment:\r\n      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry\r\n      REGISTRY_PROXY_REMOTEURL: https://registry.gitlab.com\r\n      REGISTRY_PROXY_USERNAME: $GITLAB_USER\r\n      REGISTRY_PROXY_PASSWORD: $GITLAB_TOKEN\u001b[1;26r\u001b[25;1H"]
[60.635037, "o", "\u001b[1;25r\u001b[10S\u001b[15d      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem\r\n      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem\r\n    networks:\r\n    - cache\r\n    volumes:\r\n    - type: bind\r\n      source: .\r\n      target: /host\r\n      read_only: true\r\n    - type: volume\r\n\u001b[7m--More--(96%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[63.219566, "o", "\u001b[?25l\u001b[H      target: /host                                                                          \u001b[30m\u001b[43m[0/438]\u001b[2;1H\u001b[39m\u001b[49m      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n      source: hub-cache\u001b[K\r\n      target: /var/lib/registry\u001b[K\r\n\u001b[K\r\n  gitlab-cache:\u001b[K\r\n    image: registry:2\u001b[K\r\n    restart: unless-stopped\u001b[K\r\n    environment:\u001b[K\r\n      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry                                 \u001b[K\r\n      REGISTRY_PROXY_REMOTEURL: https://registry.gitlab.com                                        \u001b[K\r\n      REGISTRY_PROXY_USERNAME: $GITLAB_USER\u001b[K\r\n      REGISTRY_PROXY_PASSWORD: $GITLAB_TOKEN\u001b[K\r\n      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem\u001b[K\r\n      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem\u001b[K\r\n    networks:\u001b[K\r\n    - cache\u001b[K\r\n    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n      target: /host\u001b[K\r\n      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n\u001b[7m--More--(96%)\u001b(B\u001b[m\u001b[K\u001b[?12l\u001b[?25h"]
[63.221029, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:[tmux]*Z 1:vi-                                               \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[25;14H\u001b[?12l\u001b[?25h"]
[63.754602, "o", "\u001b[24;19H"]
[64.25416, "o", "\u001b[23;22H"]
[64.281623, "o", "\u001b[22;20H"]
[64.311837, "o", "\u001b[21;16H"]
[64.342065, "o", "\u001b[20;17H"]
[64.372484, "o", "\u001b[19;13H"]
[64.402593, "o", "\u001b[18;12H"]
[64.433448, "o", "\u001b[17;14H"]
[64.46454, "o", "\u001b[16;47H"]
[64.49436, "o", "\u001b[15;51H"]
[64.524601, "o", "\u001b[14;45H"]
[64.554353, "o", "\u001b[13;44H"]
[64.584088, "o", "\u001b[12;60H"]
[64.615508, "o", "\u001b[11;67H"]
[64.646421, "o", "\u001b[10;17H"]
[64.677156, "o", "\u001b[9;28H"]
[64.707376, "o", "\u001b[8;22H"]
[64.737326, "o", "\u001b[7;16H"]
[64.767304, "o", "\u001b[6;1H"]
[64.797679, "o", "\u001b[5;32H"]
[65.082524, "o", "\r\n"]
[65.594389, "o", "\r\n"]
[65.794779, "o", "\u001b[30m\u001b[43m \r\u001b(B\u001b[m"]
[66.002507, "o", "\u001b[30m\u001b[43m  gitlab-cache:                                                                                     \u001b[8;1H \r\u001b(B\u001b[m"]
[66.502979, "o", "\u001b[30m\u001b[43m    image: registry:2                                                                               \u001b[9;1H \r\u001b(B\u001b[m"]
[66.533275, "o", "\u001b[30m\u001b[43m    restart: unless-stopped                                                                         \u001b[10;1H \r\u001b(B\u001b[m"]
[66.564458, "o", "\u001b[30m\u001b[43m    environment:                                                                                    \u001b[11;1H \r\u001b(B\u001b[m"]
[66.592694, "o", "\u001b[30m\u001b[43m      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry                                  \u001b[12;1H \r\u001b(B\u001b[m"]
[66.620063, "o", "\u001b[30m\u001b[43m      REGISTRY_PROXY_REMOTEURL: https://registry.gitlab.com                                         \u001b[13;1H \r\u001b(B\u001b[m"]
[66.649917, "o", "\u001b[30m\u001b[43m      REGISTRY_PROXY_USERNAME: $GITLAB_USER                                                         \u001b[14;1H \r\u001b(B\u001b[m"]
[66.67994, "o", "\u001b[30m\u001b[43m      REGISTRY_PROXY_PASSWORD: $GITLAB_TOKEN                                                        \u001b[15;1H \r\u001b(B\u001b[m"]
[66.710029, "o", "\u001b[30m\u001b[43m      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem                                                  \u001b[16;1H \r\u001b(B\u001b[m"]
[66.739623, "o", "\u001b[30m\u001b[43m      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem                                                      \u001b[17;1H \r\u001b(B\u001b[m"]
[66.769799, "o", "\u001b[30m\u001b[43m    networks:                                                                                       \u001b[18;1H \r\u001b(B\u001b[m"]
[66.803529, "o", "\u001b[30m\u001b[43m    - cache                                                                                         \u001b[19;1H \r\u001b(B\u001b[m"]
[66.832277, "o", "\u001b[30m\u001b[43m    volumes:                                                                                        \u001b[20;1H \r\u001b(B\u001b[m"]
[67.507543, "o", "\u001b[?25l\u001b[H      target: /host\u001b[K\r\n      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n      source: hub-cache\u001b[K\r\n      target: /var/lib/registry\u001b[K\r\n\u001b[K\r\n  gitlab-cache:\u001b[K\r\n    image: registry:2\u001b[K\r\n    restart: unless-stopped\u001b[K\r\n    environment:\u001b[K\r\n      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry                                 \u001b[K\r\n      REGISTRY_PROXY_REMOTEURL: https://registry.gitlab.com                                        \u001b[K\r\n      REGISTRY_PROXY_USERNAME: $GITLAB_USER\u001b[K\r\n      REGISTRY_PROXY_PASSWORD: $GITLAB_TOKEN\u001b[K\r\n      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem                                                 \u001b[K\r\n      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem\u001b[K\r\n    networks:\u001b[K\r\n    - cache\u001b[K\r\n    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n      target: /host\u001b[K\r\n      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n\u001b[7m--More--(96%)\u001b(B\u001b[m\u001b[K\u001b[?12l\u001b[?25h"]
[67.508738, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:more*Z 1:vi-                                                 \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[25;14H\u001b[?12l\u001b[?25h"]
[68.544356, "o", "\u0007"]
[69.226241, "o", "\u001b[1;25r\u001b[3S\u001b[22d      source: gitlab-cache\r\n      target: /var/lib/registry\u001b[1;26r\u001b[25;1H"]
[69.227846, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[25;1H\u001b[?12l\u001b[?25h$ "]
[71.034207, "o", "q"]
[71.890373, "o", "\b\u001b[K"]
[73.579192, "o", "docker-compose -f docker-compose.demo7.yml up -d"]
[74.78235, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[75.198029, "o", "\u001b[1;25r\u001b[7S\u001b[18d\u001b[33mWARNING\u001b[39m: The Docker Engine you're using is running in swarm mode.\u001b[20;1HCompose does not use swarm mode to deploy services to multiple nodes in a swarm. All containers will be scheduled on the current node.\u001b[23;1HTo deploy your application across the swarm, use `docker stack deploy`.\u001b[1;26r\u001b[25;1H"]
[75.228131, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[ACreating volume \"gitlab-cache\" with default driver\u001b[1;26r\u001b[25;1H"]
[75.318055, "o", "\u001b[1;25r\u001b[2S\u001b[23dStopping and removing example_builder_2 ... \r\nStopping and removing example_builder_3 ... \u001b[?25l\u001b[1;26r\u001b[26;1H\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[25;1H\u001b[?12l\u001b[?25h"]
[75.31932, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[Aexample_hub-cache_1 is up-to-date\u001b[1;26r\u001b[25;1H"]
[75.323828, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[ACreating example_gitlab-cache_1         ... \u001b[1;26r\u001b[25;1H"]
[75.818999, "o", "\u001b[A\u001b[KCreating example_gitlab-cache_1         ... \u001b[32mdone\r\n\u001b(B\u001b[m"]
[76.786987, "o", "\u001b[2A\u001b[KStopping and removing example_builder_3 ... \u001b[32mdone\u001b[25;1H\u001b(B\u001b[m"]
[76.820823, "o", "\u001b[3A\u001b[KStopping and removing example_builder_2 ... \u001b[32mdone\u001b[25;1H\u001b(B\u001b[m"]
[76.820938, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[ARecreating example_builder_1            ... \u001b[1;26r\u001b[25;1H"]
[77.092029, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitla"]
[77.092363, "o", "b-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  190,1         89%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[10;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[77.802607, "o", "\u001b[25;85H1\u001b[11;1H"]
[78.774782, "o", "\u001b[?25l\u001b[H                                                                                               \u001b[30m\u001b[43m[0/0]\u001b[2;1H\u001b[39m\u001b[49m## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian     "]
[78.774888, "o", "                                 \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitlab-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  191,1         89%\u001b[K\u001b[11;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[78.775088, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:[tmux]*                                   \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[11;1H\u001b[?12l\u001b[?25h"]
[79.094642, "o", "\u001b[30m\u001b[43md\r\u001b(B\u001b[m"]
[79.422885, "o", "\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo7.yml exec builder sh                                          \u001b[12;1H#\u001b[?25l\u001b[26;1H\u001b[42m[preso] 0:bash-Z 1:[tmux]*                                             \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[12;1H\u001b[?12l\u001b[?25h"]
[79.526695, "o", "\u001b[A\u001b[30m\u001b[43md\u001b[39m\u001b[49mocker-compose -f docker-compose.demo7.yml exec builder sh                                          \u001b[12;1H\u001b[31m\u001b[1m#\u001b[11;1H\u001b(B\u001b[m\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo7.yml exec builder sh \b\u001b(B\u001b[m"]
[80.041676, "o", "\u001b]52;;ZG9ja2VyLWNvbXBvc2UgLWYgZG9ja2VyLWNvbXBvc2UuZGVtbzcueW1sIGV4ZWMgYnVpbGRlciBzaAo=\u0007\r\u001b[?1006h\u001b[?1000h"]
[80.043922, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitla"]
[80.044014, "o", "b-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  191,1         89%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash-Z 1:vi*                                                 \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[11;1H\u001b[?12l\u001b[?25h"]
[80.748822, "o", "\u001b[?25l\u001b[H    - cache\u001b[K\r\n    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n      target: /host\u001b[K\r\n      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n      source: gitlab-cache\u001b[K\r\n      target: /var/lib/registry\u001b[K\r\n\u001b[K\r\n$ docker-compose -f docker-compose.demo7.yml up -d                                                 \u001b[K\r\n\u001b[33mWARNING\u001b[39m: The Docker Engine you're using is running in swarm mode.                                  \u001b[K\r\n\u001b[K\r\nCompose does not use swarm mode to deploy services to multiple nodes in a swarm. All containers will be scheduled on the current node.\u001b[K\r\n\u001b[K\r\nTo deploy your application across the swarm, use `docker stack deploy`.                            \u001b[K\r\n\u001b[K\r\nCreating volume \"gitlab-cache\" with default driver                                                 \u001b[K\r\nStopping and removing example_builder_2 ...\u001b[K\r\nStopping and removing example_builder_2 ... \u001b[32mdone\u001b[39m\u001b[K\r\nStopping and removing example_builder_3 ... \u001b[32mdone\u001b[39m\u001b[K\r\nCreating example_gitlab-cache_1         .."]
[80.748937, "o", ". \u001b[32mdone\u001b[39m\u001b[K\r\nRecreating example_builder_1            ... \u001b[32mdone\u001b[39m\u001b[K\r\n$\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[82.299811, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[24;3Hdocker-compose -f docker-compose.demo7.yml exec builder sh\u001b[1;26r\u001b[25;1H"]
[82.770114, "o", "/ # "]
[82.771016, "o", "\r/ # \u001b[1;25r\u001b[25;5H\u001b[K\u001b[1;26r\u001b[25;5H"]
[83.530777, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[25;5H\u001b[?12l\u001b[?25h"]
[83.947844, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitla"]
[83.9482, "o", "b-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  191,1         89%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[11;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[84.771084, "o", "\u001b[25;85H2\u001b[12;1H"]
[84.954445, "o", "\u001b[25;85H3\u001b[13;1H"]
[85.852163, "o", "\u001b[?25l\u001b[H                                                                                               \u001b[30m\u001b[43m[0/0]\u001b[2;1H\u001b[39m\u001b[49m## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian     "]
[85.85227, "o", "                                 \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitlab-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  193,1         89%\u001b[K\u001b[13;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[85.853874, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:[tmux]*                                   \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[13;1H\u001b[?12l\u001b[?25h"]
[86.491152, "o", "\u001b[30m\u001b[43me\r\u001b(B\u001b[m"]
[86.858421, "o", "\u001b[30m\u001b[43mecho \"$GITLAB_TOKEN\" | docker login -u \"$GITLAB_USER\" --password-stdin registry.gitlab.com          \u001b[14;1Hd\r\u001b(B\u001b[m"]
[87.458522, "o", "\u001b[30m\u001b[43mdocker image pull debian                                                                            \u001b[15;1Hd\r\u001b(B\u001b[m"]
[88.488569, "o", "\u001b[30m\u001b[43mdocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                 \u001b[16;1Hd\r\u001b(B\u001b[m"]
[89.634956, "o", "\u001b[A\u001b[30m\u001b[43md\u001b[39m\u001b[49mocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                 \u001b[16;1Hd\u001b[15;1H\u001b[30m\u001b[43mdocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian \b\u001b(B\u001b[m"]
[90.65054, "o", "\r\u001b[30m\u001b[43mdocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian\u001b[39m\u001b[49m \b\b"]
[91.632663, "o", "\u001b]52;;ZWNobyAiJEdJVExBQl9UT0tFTiIgfCBkb2NrZXIgbG9naW4gLXUgIiRHSVRMQUJfVVNFUiIgLS1wYXNzd29yZC1zdGRpbiByZWdpc3RyeS5naXRsYWIuY29tCmRvY2tlciBpbWFnZSBwdWxsIGRlYmlhbgpkb2NrZXIgaW1hZ2UgdGFnIGRlYmlhbiByZWdpc3RyeS5naXRsYWIuY29tL3N1ZG8tYm1pdGNoL2RlbW86ZGViaWFu\u0007\u001b[13;1H\u001b[?1006h\u001b[?1000h"]
[91.633164, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitla"]
[91.633268, "o", "b-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  193,1         89%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[13;1H\u001b[?12l\u001b[?25h"]
[92.34798, "o", "\u001b[?25l\u001b[H    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n      target: /host\u001b[K\r\n      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n      source: gitlab-cache\u001b[K\r\n      target: /var/lib/registry\u001b[K\r\n\u001b[K\r\n$ docker-compose -f docker-compose.demo7.yml up -d                                                 \u001b[K\r\n\u001b[33mWARNING\u001b[39m: The Docker Engine you're using is running in swarm mode.                                  \u001b[K\r\n\u001b[K\r\nCompose does not use swarm mode to deploy services to multiple nodes in a swarm. All containers will be scheduled on the current node.\u001b[K\r\n\u001b[K\r\nTo deploy your application across the swarm, use `docker stack deploy`.                            \u001b[K\r\n\u001b[K\r\nCreating volume \"gitlab-cache\" with default driver                                                 \u001b[K\r\nStopping and removing example_builder_2 ...\u001b[K\r\nStopping and removing example_builder_2 ... \u001b[32mdone\u001b[39m\u001b[K\r\nStopping and removing example_builder_3 ... \u001b[32mdone\u001b[39m\u001b[K\r\nCreating example_gitlab-cache_1         ... \u001b[32mdone\u001b[39m"]
[92.348089, "o", "\u001b[K\r\nRecreating example_builder_1            ... \u001b[32mdone\u001b[39m\u001b[K\r\n$ docker-compose -f docker-compose.demo7.yml exec builder sh                                       \u001b[K\r\n/ #\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[25;5H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[93.315832, "o", "echo \"$GITLAB_TOKEN\" | docker login -u \"$GITLAB_USER\" --password-stdin registry.gitlab.co"]
[93.316151, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[24;94Hm\u001b[1;26r\u001b[25;1H"]
[93.803863, "o", "\u001b[1;25r\u001b[4S\u001b[21dWARNING! Your password will be stored unencrypted in /root/.docker/config.json.\r\nConfigure a credential helper to remove this warning. See\r\nhttps://docs.docker.com/engine/reference/commandline/login/#credentials-store\u001b[1;26r\u001b[25;1H"]
[93.804597, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[ALogin Succeeded\u001b[1;26r\u001b[25;1H"]
[93.808092, "o", "/ # docker image pul\u001b[1;25r\u001b[25;1H\n\u001b[24;21Hl debian"]
[93.808378, "o", "\u001b[1;26r\u001b[25;1H"]
[93.856406, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[AUsing default tag: latest\u001b[1;26r\u001b[25;1H"]
[94.145334, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[Alatest: Pulling from library/debian\u001b[1;26r\u001b[25;1H"]
[94.316201, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A90fe46dd8199: Pulling fs layer \u001b[1;26r\u001b[25;1H"]
[94.773406, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  507.9kB/50.38MB\r\n"]
[95.043392, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  1.024MB/50.38MB\r\n"]
[95.257737, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  2.564MB/50.38MB\r\n"]
[95.467333, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading   3.58MB/50.38MB\r\n"]
[95.613317, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  4.088MB/50.38MB\r\n"]
[96.665243, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  4.596MB/50.38MB\r\n"]
[96.848155, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading   5.62MB/50.38MB\r\n"]
[97.020341, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  6.644MB/50.38MB\r\n"]
[97.682859, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading   7.16MB/50.38MB\r\n"]
[98.539877, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  8.192MB/50.38MB\r\n"]
[98.868464, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  8.711MB/50.38MB\r\n"]
[98.977602, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  9.216MB/50.38MB\r\n"]
[99.456715, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  9.727MB/50.38MB\r\n"]
[99.62626, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  10.74MB/50.38MB\r\n"]
[99.761329, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  11.25MB/50.38MB\r\n"]
[99.943701, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  11.76MB/50.38MB\r\n"]
[100.079992, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  12.27MB/50.38MB\r\n"]
[100.377905, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  12.78MB/50.38MB\r\n"]
[100.590076, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading   13.3MB/50.38MB\r\n"]
[100.830114, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  13.81MB/50.38MB\r\n"]
[101.003187, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  14.83MB/50.38MB\r\n"]
[101.142555, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  15.35MB/50.38MB\r\n"]
[101.378403, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  15.87MB/50.38MB\r\n"]
[101.550335, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  16.89MB/50.38MB\r\n"]
[102.257658, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  17.41MB/50.38MB\r\n"]
[102.641617, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  18.43MB/50.38MB\r\n"]
[102.801101, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  18.95MB/50.38MB\r\n"]
[103.232673, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  19.47MB/50.38MB\r\n"]
[103.434768, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  19.99MB/50.38MB\r\n"]
[103.6562, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  21.02MB/50.38MB\r\n"]
[103.852645, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  22.03MB/50.38MB\r\n"]
[103.984442, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  22.54MB/50.38MB\r\n"]
[104.103983, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  23.06MB/50.38MB\r\n"]
[104.402907, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  24.07MB/50.38MB\r\n"]
[105.246482, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  24.59MB/50.38MB\r\n"]
[105.349794, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading   25.1MB/50.38MB\r\n"]
[105.559682, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  25.61MB/50.38MB\r\n"]
[105.700015, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  26.12MB/50.38MB\r\n"]
[105.827506, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  26.63MB/50.38MB\r\n"]
[106.022721, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  27.15MB/50.38MB\r\n"]
[106.233831, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  27.66MB/50.38MB\r\n"]
[106.406784, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  28.18MB/50.38MB\r\n"]
[106.59247, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading   29.2MB/50.38MB\r\n"]
[106.697588, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  30.23MB/50.38MB\r\n"]
[107.570847, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  30.73MB/50.38MB\r\n"]
[107.804614, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  31.25MB/50.38MB\r\n"]
[108.296767, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  31.77MB/50.38MB\r\n"]
[108.601637, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  32.28MB/50.38MB\r\n"]
[108.795988, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  32.79MB/50.38MB\r\n"]
[108.921862, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  33.81MB/50.38MB\r\n"]
[109.104505, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  35.34MB/50.38MB\r\n"]
[109.250974, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  36.35MB/50.38MB\r\n"]
[109.38654, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  37.37MB/50.38MB\r\n"]
[109.528439, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  38.39MB/50.38MB\r\n"]
[109.635864, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  38.89MB/50.38MB\r\n"]
[109.785091, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  39.41MB/50.38MB\r\n"]
[109.893553, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  40.43MB/50.38MB\r\n"]
[110.077571, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  41.45MB/50.38MB\r\n"]
[110.213999, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  41.96MB/50.38MB\r\n"]
[110.388579, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  42.47MB/50.38MB\r\n"]
[110.545867, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  42.98MB/50.38MB\r\n"]
[110.686523, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  43.49MB/50.38MB\r\n"]
[110.851582, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading     44MB/50.38MB\r\n"]
[111.124527, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading   44.5MB/50.38MB\r\n"]
[111.287852, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  45.53MB/50.38MB\r\n"]
[111.422529, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  46.04MB/50.38MB\r\n"]
[111.713993, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  47.07MB/50.38MB\r\n"]
[111.999115, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  47.58MB/50.38MB\r\n"]
[112.41255, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  48.08MB/50.38MB\r\n"]
[112.742128, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading  48.59MB/50.38MB\r\n"]
[112.87468, "o", "\u001b[A\u001b[K90fe46dd8199: Downloading   49.1MB/50.38MB\r\n"]
[112.913931, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitla"]
[112.914143, "o", "b-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  193,1         89%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:07 10-May-20\u001b(B\u001b[m\u001b[13;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[115.362873, "o", "\u001b[25;85H4\u001b[14;1H"]
[115.578727, "o", "\u001b[25;85H5\u001b[15;1H"]
[115.772203, "o", "\u001b[25;85H6\u001b[16;1H"]
[116.490047, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:08 10-May-20\u001b(B\u001b[m\u001b[16;1H\u001b[?12l\u001b[?25h"]
[116.89248, "o", "\u001b[?25l\u001b[H                                                                                               \u001b[30m\u001b[43m[0/0]\u001b[2;1H\u001b[39m\u001b[49m## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian     "]
[116.892767, "o", "                                 \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitlab-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  196,1         89%\u001b[K\u001b[16;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[116.893902, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:[tmux]*                                   \"bmitch-t490\" 18:08 10-May-20\u001b(B\u001b[m\u001b[16;1H\u001b[?12l\u001b[?25h"]
[117.303728, "o", "\u001b[30m\u001b[43md\r\u001b(B\u001b[m"]
[117.75491, "o", "\u001b[30m\u001b[43mdocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                       \u001b[17;1H#\r\u001b(B\u001b[m"]
[117.850871, "o", "\u001b[A\u001b[30m\u001b[43md\u001b[39m\u001b[49mocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                       \u001b[17;1H\u001b[31m\u001b[1m#\u001b[16;1H\u001b(B\u001b[m\u001b[30m\u001b[43mdocker image push registry.gitlab.com/sudo-bmitch/demo:debian \b\u001b(B\u001b[m"]
[118.750666, "o", "\u001b]52;;ZG9ja2VyIGltYWdlIHB1c2ggcmVnaXN0cnkuZ2l0bGFiLmNvbS9zdWRvLWJtaXRjaC9kZW1vOmRlYmlhbgo=\u0007\r\u001b[?1006h\u001b[?1000h"]
[118.751181, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitla"]
[118.751207, "o", "b-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  196,1         89%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:08 10-May-20\u001b(B\u001b[m\u001b[16;1H\u001b[?12l\u001b[?25h"]
[119.699838, "o", "\u001b[?25l\u001b[H be scheduled on the current node.\u001b[K\r\n\u001b[K\r\nTo deploy your application across the swarm, use `docker stack deploy`.                            \u001b[K\r\n\u001b[K\r\nCreating volume \"gitlab-cache\" with default driver                                                 \u001b[K\r\nStopping and removing example_builder_2 ...\u001b[K\r\nStopping and removing example_builder_2 ... \u001b[32mdone\u001b[39m\u001b[K\r\nStopping and removing example_builder_3 ... \u001b[32mdone\u001b[39m\u001b[K\r\nCreating example_gitlab-cache_1         ... \u001b[32mdone\u001b[39m\u001b[K\r\nRecreating example_builder_1            ... \u001b[32mdone\u001b[39m\u001b[K\r\n$ docker-compose -f docker-compose.demo7.yml exec builder sh                                       \u001b[K\r\n/ # echo \"$GITLAB_TOKEN\" | docker login -u \"$GITLAB_USER\" --password-stdin registry.gitlab.com     \u001b[K\r\nWARNING! Your password will be stored unencrypted in /root/.docker/config.json.                    \u001b[K\r\nConfigure a credential helper to remove this warning. See                                          \u001b[K\r\nhttps://docs.docker.com/engine/reference/c"]
[119.699954, "o", "ommandline/login/#credentials-store                      \u001b[K\r\n\u001b[K\r\nLogin Succeeded\u001b[K\r\n/ # docker image pull debian\u001b[K\r\nUsing default tag: latest\u001b[K\r\nlatest: Pulling from library/debian\u001b[K\r\n90fe46dd8199: Pull complete\u001b[K\r\nDigest: sha256:2857989334428416b1ef369d6e029e912a7fe3ee7e57adc20b494cc940198258                    \u001b[K\r\nStatus: Downloaded newer image for debian:latest\u001b[K\r\ndocker.io/library/debian:latest\u001b[K\r\n/ # docker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                            \u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:08 10-May-20\u001b(B\u001b[m\u001b[25;72H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[121.450941, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[121.516224, "o", "/ # "]
[122.700137, "o", "docker image push registry.gi\u001b[1;25r\u001b[25;1H\n\u001b[24;34Htlab.com/sudo-bmitch/demo:debian"]
[122.700462, "o", "\u001b[1;26r\u001b[25;1H"]
[122.801746, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[AThe push refers to repository [registry.gitlab.com/sudo-bmitch/demo]\u001b[1;26r\u001b[25;1H"]
[122.898153, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[Ae40d297cf5f8: Preparing \u001b[1;26r\u001b[25;1H"]
[123.381978, "o", "\u001b[A\u001b[Ke40d297cf5f8: Layer already exists \r\n"]
[124.502979, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[Adebian: digest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16 size: 529\u001b[1;26r\u001b[25;1H"]
[124.510924, "o", "/ # "]
[126.140341, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitla"]
[126.140847, "o", "b-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  196,1         89%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:08 10-May-20\u001b(B\u001b[m\u001b[16;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[126.898709, "o", "\u001b[25;85H7\u001b[17;1H"]
[127.0907, "o", "\u001b[25;85H8\u001b[18;1H"]
[127.868155, "o", "\u001b[?25l\u001b[H                                                                                               \u001b[30m\u001b[43m[0/0]\u001b[2;1H\u001b[39m\u001b[49m## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian     "]
[127.86826, "o", "                                 \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitlab-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  198,1         89%\u001b[K\u001b[18;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[128.163662, "o", "\u001b[30m\u001b[43md\u001b[?25l\u001b[26;1H\u001b[42m[preso] 0:docker-compose-Z 1:[tmux]*                                   \"bmitch-t490\" 18:08 10-May-20\u001b(B\u001b[m\u001b[18;1H\u001b[?12l\u001b[?25h"]
[128.46465, "o", "\u001b[30m\u001b[43mdocker image pull gitlab-cache:5000/sudo-bmitch/demo:debian                                         \u001b[19;1H`\r\u001b(B\u001b[m"]
[128.575917, "o", "\u001b[A\u001b[30m\u001b[43md\u001b[39m\u001b[49mocker image pull gitlab-cache:5000/sudo-bmitch/demo:debian                                         \u001b[19;1H\u001b[31m\u001b[1m`\u001b[18;1H\u001b(B\u001b[m\u001b[30m\u001b[43mdocker image pull gitlab-cache:5000/sudo-bmitch/demo:debian \b\u001b(B\u001b[m"]
[129.178017, "o", "\u001b]52;;ZG9ja2VyIGltYWdlIHB1bGwgZ2l0bGFiLWNhY2hlOjUwMDAvc3Vkby1ibWl0Y2gvZGVtbzpkZWJpYW4K\u0007\r\u001b[?1006h\u001b[?1000h"]
[129.180678, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 7 - Setup Cache for Gitlab\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update the certs for gitlab-cache hostname\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo7.sh\u001b[K\r\n./make-certs.demo7.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m deploy the project\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo7.yml\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo7.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m login to gitlab, pull a sample image, and push to gitlab\u001b(B\u001b[m                                         \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image pull debian\u001b[K\r\ndocker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                                \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m now we can pull through the cache\u001b(B\u001b[m\u001b[K\r\ndocker image pull gitla"]
[129.181012, "o", "b-cache:5000/sudo-bmitch/demo:debian                                        \u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\n                                                                                  198,1         89%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:08 10-May-20\u001b(B\u001b[m\u001b[18;1H\u001b[?12l\u001b[?25h"]
[129.94809, "o", "\u001b[?25l\u001b[HStopping and removing example_builder_2 ...\u001b[K\r\nStopping and removing example_builder_2 ... \u001b[32mdone\u001b[39m\u001b[K\r\nStopping and removing example_builder_3 ... \u001b[32mdone\u001b[39m\u001b[K\r\nCreating example_gitlab-cache_1         ... \u001b[32mdone\u001b[39m\u001b[K\r\nRecreating example_builder_1            ... \u001b[32mdone\u001b[39m\u001b[K\r\n$ docker-compose -f docker-compose.demo7.yml exec builder sh                                       \u001b[K\r\n/ # echo \"$GITLAB_TOKEN\" | docker login -u \"$GITLAB_USER\" --password-stdin registry.gitlab.com     \u001b[K\r\nWARNING! Your password will be stored unencrypted in /root/.docker/config.json.                    \u001b[K\r\nConfigure a credential helper to remove this warning. See                                          \u001b[K\r\nhttps://docs.docker.com/engine/reference/commandline/login/#credentials-store                      \u001b[K\r\n\u001b[K\r\nLogin Succeeded\u001b[K\r\n/ # docker image pull debian\u001b[K\r\nUsing default tag: latest\u001b[K\r\nlatest: Pulling from library/debian\u001b[K\r\n90fe46dd8199: Pull complete\u001b[K\r\nDigest: sha256:2857989334428416b1ef"]
[129.948427, "o", "369d6e029e912a7fe3ee7e57adc20b494cc940198258                    \u001b[K\r\nStatus: Downloaded newer image for debian:latest\u001b[K\r\ndocker.io/library/debian:latest\u001b[K\r\n/ # docker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                            \u001b[K\r\n/ # docker image push registry.gitlab.com/sudo-bmitch/demo:debian                                  \u001b[K\r\nThe push refers to repository [registry.gitlab.com/sudo-bmitch/demo]                               \u001b[K\r\ne40d297cf5f8: Layer already exists\u001b[K\r\ndebian: digest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16 size: 529  \u001b[K\r\n/ #\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:08 10-May-20\u001b(B\u001b[m\u001b[25;5H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[131.219881, "o", "docker image pull gitlab-cache:5000"]
[131.220321, "o", "/sudo-bmitch/dem\u001b[1;25r\u001b[25;1H\n\u001b[24;56Ho:debian\u001b[1;26r\u001b[25;1H"]
[131.864387, "o", "\u001b[1;25r\u001b[2S\u001b[23ddebian: Pulling from sudo-bmitch/demo\r\nDigest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16\u001b[1;26r\u001b[25;1H"]
[131.867716, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[AStatus: Downloaded newer image for gitlab-cache:5000/sudo-bmitch/demo:debian\u001b[1;26r\u001b[25;1H"]
[131.868439, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[Agitlab-cache:5000/sudo-bmitch/demo:debian\u001b[1;26r\u001b[25;1H"]
[131.872204, "o", "/ # "]
