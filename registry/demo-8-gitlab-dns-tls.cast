{"version": 2, "width": 100, "height": 26, "timestamp": 1589148584, "idle_time_limit": 3.0, "env": {"SHELL": "/bin/bash", "TERM": "xterm-256color"}}
[0.003167, "o", "\u001b[?1049h\u001b[22;0;0t\u001b[?1h\u001b=\u001b[H\u001b[2J\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1002l\u001b[?1006l\u001b[?1005l\u001b[c\u001b(B\u001b[m\u001b[?12;25h\u001b[?12l\u001b[?25h\u001b[?1003l\u001b[?1006l\u001b[?2004l\u001b[1;1H\u001b[1;26r\u001b]112\u0007\u001b[7;1H\u001b[?1006h\u001b[?1000h"]
[0.003553, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[0.003596, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  205,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:09 10-May-20\u001b(B\u001b[m\u001b[7;1H\u001b[?12l\u001b[?25h\u001b(B\u001b[m\u001b[?12;25h\u001b[?12l\u001b[?25h\u001b[?1003l\u001b[?1006l\u001b[?2004l\u001b[1;1H\u001b[1;26r\u001b[7;1H\u001b[?1006h\u001b[?1000h"]
[0.003627, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[0.003655, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  205,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:09 10-May-20\u001b(B\u001b[m\u001b[7;1H\u001b[?12l\u001b[?25h"]
[3.799552, "o", "\u001b[25;85H6\u001b[8;1H"]
[4.704759, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m                                                                                            \u001b[30m\u001b[43m[0/0]\u001b[39m\u001b[49m\u001b[2;1H\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose."]
[4.704917, "o", "demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  206,1         98%\u001b[K\u001b[8;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[4.706148, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:[tmux]*                                   \"bmitch-t490\" 18:09 10-May-20\u001b(B\u001b[m\u001b[8;1H\u001b[?12l\u001b[?25h"]
[4.991276, "o", "\u001b[30m\u001b[43m.\r\u001b(B\u001b[m"]
[5.271067, "o", "\u001b[30m\u001b[43m./make-certs.demo8.sh                                                                               \u001b[9;1H#\r\u001b(B\u001b[m"]
[5.375301, "o", "\u001b[A\u001b[30m\u001b[43m.\u001b[39m\u001b[49m/make-certs.demo8.sh                                                                               \u001b[9;1H\u001b[31m\u001b[1m#\u001b[8;1H\u001b(B\u001b[m\u001b[30m\u001b[43m./make-certs.demo8.sh \b\u001b(B\u001b[m"]
[6.591141, "o", "\r\u001b[30m\u001b[43m./make-certs.demo8.sh\u001b[39m\u001b[49m \b\b"]
[7.118074, "o", "\u001b]52;;Li9tYWtlLWNlcnRzLmRlbW84LnNo\u0007\r\u001b[?1006h\u001b[?1000h"]
[7.12022, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[7.120298, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  206,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:09 10-May-20\u001b(B\u001b[m\u001b[8;1H\u001b[?12l\u001b[?25h"]
[8.136034, "o", "\u001b[?25l\u001b[H$ docker-compose -f docker-compose.demo7.yml exec builder sh                                       \u001b[K\r\n/ # echo \"$GITLAB_TOKEN\" | docker login -u \"$GITLAB_USER\" --password-stdin registry.gitlab.com     \u001b[K\r\nWARNING! Your password will be stored unencrypted in /root/.docker/config.json.                    \u001b[K\r\nConfigure a credential helper to remove this warning. See                                          \u001b[K\r\nhttps://docs.docker.com/engine/reference/commandline/login/#credentials-store                      \u001b[K\r\n\u001b[K\r\nLogin Succeeded\u001b[K\r\n/ # docker image pull debian\u001b[K\r\nUsing default tag: latest\u001b[K\r\nlatest: Pulling from library/debian\u001b[K\r\n90fe46dd8199: Pull complete\u001b[K\r\nDigest: sha256:2857989334428416b1ef369d6e029e912a7fe3ee7e57adc20b494cc940198258                    \u001b[K\r\nStatus: Downloaded newer image for debian:latest\u001b[K\r\ndocker.io/library/debian:latest\u001b[K\r\n/ # docker image tag debian registry.gitlab.com/sudo-bmitch/demo:debian                            \u001b[K\r\n/ # docker image push registry.gitlab."]
[8.13613, "o", "com/sudo-bmitch/demo:debian                                  \u001b[K\r\nThe push refers to repository [registry.gitlab.com/sudo-bmitch/demo]                               \u001b[K\r\ne40d297cf5f8: Layer already exists\u001b[K\r\ndebian: digest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16 size: 529  \u001b[K\r\n/ # docker image pull gitlab-cache:5000/sudo-bmitch/demo:debian                                    \u001b[K\r\ndebian: Pulling from sudo-bmitch/demo\u001b[K\r\nDigest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16                    \u001b[K\r\nStatus: Downloaded newer image for gitlab-cache:5000/sudo-bmitch/demo:debian                       \u001b[K\r\ngitlab-cache:5000/sudo-bmitch/demo:debian\u001b[K\r\n/ #\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:09 10-May-20\u001b(B\u001b[m\u001b[25;5H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[9.332627, "o", "m"]
[9.428177, "o", "o"]
[9.507995, "o", "r"]
[9.595418, "o", "e"]
[10.215402, "o", " "]
[11.020652, "o", "./make-certs.demo8.sh"]
[11.791784, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[11.795449, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[Amore: ./make-certs.demo8.sh: No such file or directory\u001b[1;26r\u001b[25;1H/ # "]
[13.975382, "o", "m"]
[14.071449, "o", "o"]
[14.126055, "o", "r"]
[14.191164, "o", "e"]
[14.511765, "o", " "]
[14.815339, "o", "m"]
[14.934903, "o", "a"]
[15.007075, "o", "k"]
[15.151155, "o", "\u0007"]
[16.160039, "o", "\u001b[1;25r\u001b[25;12H\u001b[K\u001b[1;26r\u001b[25;12H"]
[16.660472, "o", "\u001b[1;25r\u001b[25;11H\u001b[K\u001b[1;26r\u001b[25;11H"]
[16.690866, "o", "\u001b[1;25r\u001b[25;10H\u001b[K\u001b[1;26r\u001b[25;10H"]
[16.722051, "o", "\u001b[1;25r\u001b[25;9H\u001b[K\u001b[1;26r\u001b[25;9H"]
[16.750362, "o", "\u001b[1;25r\u001b[25;8H\u001b[K\u001b[1;26r\u001b[25;8H"]
[16.778641, "o", "\u001b[1;25r\u001b[25;7H\u001b[K\u001b[1;26r\u001b[25;7H"]
[16.811843, "o", "\u001b[1;25r\u001b[25;6H\u001b[K\u001b[1;26r\u001b[25;6H"]
[16.840539, "o", "\u001b[1;25r\u001b[25;5H\u001b[K\u001b[1;26r\u001b[25;5H"]
[17.32505, "o", "l"]
[17.412336, "o", "s"]
[17.551138, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[17.553373, "o", "\u001b[1;25r\u001b[2S\u001b[23d\u001b[34m\u001b[1mbin\u001b(B\u001b[m    \u001b[34m\u001b[1mdev\u001b(B\u001b[m    \u001b[34m\u001b[1mhome\u001b(B\u001b[m   \u001b[34m\u001b[1mmedia\u001b(B\u001b[m  \u001b[34m\u001b[1mopt\u001b(B\u001b[m    \u001b[34m\u001b[1mroot\u001b(B\u001b[m   \u001b[34m\u001b[1msbin\u001b(B\u001b[m   \u001b[34m\u001b[1msys\u001b(B\u001b[m    \u001b[34m\u001b[1musr\r\ncerts\u001b(B\u001b[m  \u001b[34m\u001b[1metc\u001b(B\u001b[m    \u001b[34m\u001b[1mlib\u001b(B\u001b[m    \u001b[34m\u001b[1mmnt\u001b(B\u001b[m    \u001b[34m\u001b[1mproc\u001b(B\u001b[m   \u001b[34m\u001b[1mrun\u001b(B\u001b[m    \u001b[34m\u001b[1msrv\u001b(B\u001b[m    \u001b[34m\u001b[1mtmp\u001b(B\u001b[m    \u001b[34m\u001b[1mvar\u001b[1;26r\u001b[25;1H\u001b(B\u001b[m/ # "]
[19.935524, "o", "e"]
[20.14813, "o", "x"]
[20.311089, "o", "i"]
[20.391629, "o", "t"]
[20.719303, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[20.827715, "o", "$ "]
[21.77176, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:10 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h"]
[22.214781, "o", "m"]
[22.350425, "o", "o"]
[22.429954, "o", "r"]
[22.508642, "o", "e"]
[22.607034, "o", " "]
[23.3835, "o", "./make-certs.demo8.sh"]
[24.055214, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[24.058238, "o", "\u001b[1;25r\u001b[5S\u001b[20d#!/bin/sh\u001b[22;1H[ -f ca-key.pem ] || openssl genrsa -out ca-key.pem 4096\r\nopenssl req -new -x509 -days 365 -subj \"/CN=Local CA\" -key ca-key.pem -sha256 -out ca.pem\r\n[ -f reg-key.pem ] || openssl genrsa -out reg-key.pem 4096\u001b[1;26r\u001b[25;1H\u001b[1;25r\u001b[7S\u001b[18d[ -f reg.csr ] || openssl req -new -subj \"/CN=Registry\" -key reg-key.pem -out reg.csr\r\necho \"subjectAltName = DNS:hub-cache,DNS:gitlab-cache,DNS:registry.gitlab.com\" >reg.ext\r\nopenssl x509 -req -days 365 -in reg.csr -extfile reg.ext -CA ca.pem -CAkey ca-key.pem -CAcreateseria\u001b[21;1Hl -out reg.pem\u001b[1;26r\u001b[25;1H"]
[24.058758, "o", "$ "]
[28.960722, "o", "\u001b[?25l\u001b[H/ # docker image pull gitlab-cache:5000/sudo-bmitch/demo:debian                              \u001b[30m\u001b[43m[0/498]\u001b[2;1H\u001b[39m\u001b[49mdebian: Pulling from sudo-bmitch/demo\u001b[K\r\nDigest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16                    \u001b[K\r\nStatus: Downloaded newer image for gitlab-cache:5000/sudo-bmitch/demo:debian                       \u001b[K\r\ngitlab-cache:5000/sudo-bmitch/demo:debian\u001b[K\r\n/ # more ./make-certs.demo8.sh\u001b[K\r\nmore: ./make-certs.demo8.sh: No such file or directory                                             \u001b[K\r\n/ # ls\u001b[K\r\n\u001b[34m\u001b[1mbin\u001b(B\u001b[m    \u001b[34m\u001b[1mdev\u001b(B\u001b[m    \u001b[34m\u001b[1mhome\u001b(B\u001b[m   \u001b[34m\u001b[1mmedia\u001b(B\u001b[m  \u001b[34m\u001b[1mopt\u001b(B\u001b[m    \u001b[34m\u001b[1mroot\u001b(B\u001b[m   \u001b[34m\u001b[1msbin\u001b(B\u001b[m   \u001b[34m\u001b[1msys\u001b(B\u001b[m    \u001b[34m\u001b[1musr\u001b(B\u001b[m                                        \u001b[K\r\n\u001b[34m\u001b[1mcerts\u001b(B\u001b[m  \u001b[34m\u001b[1metc\u001b(B\u001b[m    \u001b[34m\u001b[1mlib\u001b(B\u001b[m    \u001b[34m\u001b[1mmnt\u001b(B\u001b[m    \u001b[34m\u001b[1mproc\u001b(B\u001b[m   \u001b[34m\u001b[1mrun\u001b(B\u001b[m    \u001b[34m\u001b[1msrv\u001b(B\u001b[m    \u001b[34m\u001b[1mtmp\u001b(B\u001b[m    \u001b[34m\u001b[1mvar\u001b(B\u001b[m          "]
[28.960887, "o", "                              \u001b[K\r\n/ # exit\u001b[K\r\n$ more ./make-certs.demo8.sh\u001b[K\r\n#!/bin/sh\u001b[K\r\n\u001b[K\r\n[ -f ca-key.pem ] || openssl genrsa -out ca-key.pem 4096                                           \u001b[K\r\nopenssl req -new -x509 -days 365 -subj \"/CN=Local CA\" -key ca-key.pem -sha256 -out ca.pem          \u001b[K\r\n[ -f reg-key.pem ] || openssl genrsa -out reg-key.pem 4096                                         \u001b[K\r\n[ -f reg.csr ] || openssl req -new -subj \"/CN=Registry\" -key reg-key.pem -out reg.csr              \u001b[K\r\necho \"subjectAltName = DNS:hub-cache,DNS:gitlab-cache,DNS:registry.gitlab.com\" >reg.ext            \u001b[K\r\nopenssl x509 -req -days 365 -in reg.csr -extfile reg.ext -CA ca.pem -CAkey ca-key.pem -CAcreateseria\u001b[21;1Hl -out reg.pem\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n$\u001b[K\u001b[C\u001b[?12l\u001b[?25h"]
[28.9622, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:[tmux]*Z 1:vi-                                               \"bmitch-t490\" 18:10 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h"]
[29.559522, "o", "\u001b[24;1H"]
[30.060084, "o", "\u001b[A"]
[30.090814, "o", "\u001b[A"]
[30.122203, "o", "\u001b[21;15H"]
[30.575388, "o", "\u001b[20;100H$\u001b[20;100H"]
[30.798995, "o", "\u001b[19;88H"]
[30.991189, "o", "\u001b[18;86H"]
[31.349603, "o", "\u001b[19;88H"]
[31.551208, "o", "\b"]
[32.051515, "o", "\b"]
[32.081999, "o", "\b"]
[32.112412, "o", "\b"]
[32.140481, "o", "\b"]
[32.169983, "o", "\b"]
[32.199604, "o", "\b"]
[32.230283, "o", "\b"]
[32.564324, "o", "\b"]
[32.758863, "o", "\b"]
[32.951321, "o", "\u001b[30m\u001b[43m\"\u001b[20;100H\u001b[39m\u001b[49ma\u001b[19;78H"]
[33.135014, "o", "\b\u001b[30m\u001b[43mm\"\b\b\u001b(B\u001b[m"]
[33.634799, "o", "\b\u001b[30m\u001b[43mom\"\u001b[3D\u001b(B\u001b[m"]
[33.666065, "o", "\b\u001b[30m\u001b[43mcom\"\u001b[4D\u001b(B\u001b[m"]
[33.695604, "o", "\b\u001b[30m\u001b[43m.com\"\u001b[5D\u001b(B\u001b[m"]
[33.727314, "o", "\b\u001b[30m\u001b[43mb.com\"\u001b[6D\u001b(B\u001b[m"]
[33.755426, "o", "\b\u001b[30m\u001b[43mab.com\"\u001b[7D\u001b(B\u001b[m"]
[33.785698, "o", "\b\u001b[30m\u001b[43mlab.com\"\u001b[8D\u001b(B\u001b[m"]
[33.81468, "o", "\b\u001b[30m\u001b[43mtlab.com\"\u001b[9D\u001b(B\u001b[m"]
[33.845525, "o", "\b\u001b[30m\u001b[43mitlab.com\"\u001b[10D\u001b(B\u001b[m"]
[33.876188, "o", "\b\u001b[30m\u001b[43mgitlab.com\"\u001b[11D\u001b(B\u001b[m"]
[33.906263, "o", "\b\u001b[30m\u001b[43m.gitlab.com\"\u001b[12D\u001b(B\u001b[m"]
[33.938112, "o", "\b\u001b[30m\u001b[43my.gitlab.com\"\u001b[13D\u001b(B\u001b[m"]
[33.966044, "o", "\b\u001b[30m\u001b[43mry.gitlab.com\"\u001b[14D\u001b(B\u001b[m"]
[33.996176, "o", "\b\u001b[30m\u001b[43mtry.gitlab.com\"\u001b[15D\u001b(B\u001b[m"]
[34.026621, "o", "\b\u001b[30m\u001b[43mstry.gitlab.com\"\u001b[16D\u001b(B\u001b[m"]
[34.057452, "o", "\b\u001b[30m\u001b[43mistry.gitlab.com\"\u001b[17D\u001b(B\u001b[m"]
[34.08993, "o", "\b\u001b[30m\u001b[43mgistry.gitlab.com\"\u001b[18D\u001b(B\u001b[m"]
[34.120383, "o", "\b\u001b[30m\u001b[43megistry.gitlab.com\"\u001b[19D\u001b(B\u001b[m"]
[34.150537, "o", "\b\u001b[30m\u001b[43mregistry.gitlab.com\"\u001b[20D\u001b(B\u001b[m"]
[34.181067, "o", "\b\u001b[30m\u001b[43m:registry.gitlab.com\"\u001b[21D\u001b(B\u001b[m"]
[34.209038, "o", "\b\u001b[30m\u001b[43mS:registry.gitlab.com\"\u001b[22D\u001b(B\u001b[m"]
[34.239752, "o", "\b\u001b[30m\u001b[43mNS:registry.gitlab.com\"\u001b[23D\u001b(B\u001b[m"]
[34.460212, "o", "\b\u001b[30m\u001b[43mDNS:registry.gitlab.com\"\u001b[24D\u001b(B\u001b[m"]
[34.659623, "o", "\b\u001b[30m\u001b[43m,DNS:registry.gitlab.com\"\u001b[25D\u001b(B\u001b[m"]
[36.737056, "o", "\u001b[?25l\u001b[H/ # docker image pull gitlab-cache:5000/sudo-bmitch/demo:debian                                    \u001b[K\r\ndebian: Pulling from sudo-bmitch/demo\u001b[K\r\nDigest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16                    \u001b[K\r\nStatus: Downloaded newer image for gitlab-cache:5000/sudo-bmitch/demo:debian                       \u001b[K\r\ngitlab-cache:5000/sudo-bmitch/demo:debian\u001b[K\r\n/ # more ./make-certs.demo8.sh\u001b[K\r\nmore: ./make-certs.demo8.sh: No such file or directory                                             \u001b[K\r\n/ # ls\u001b[K\r\n\u001b[34m\u001b[1mbin\u001b(B\u001b[m    \u001b[34m\u001b[1mdev\u001b(B\u001b[m    \u001b[34m\u001b[1mhome\u001b(B\u001b[m   \u001b[34m\u001b[1mmedia\u001b(B\u001b[m  \u001b[34m\u001b[1mopt\u001b(B\u001b[m    \u001b[34m\u001b[1mroot\u001b(B\u001b[m   \u001b[34m\u001b[1msbin\u001b(B\u001b[m   \u001b[34m\u001b[1msys\u001b(B\u001b[m    \u001b[34m\u001b[1musr\u001b(B\u001b[m                                        \u001b[K\r\n\u001b[34m\u001b[1mcerts\u001b(B\u001b[m  \u001b[34m\u001b[1metc\u001b(B\u001b[m    \u001b[34m\u001b[1mlib\u001b(B\u001b[m    \u001b[34m\u001b[1mmnt\u001b(B\u001b[m    \u001b[34m\u001b[1mproc\u001b(B\u001b[m   \u001b[34m\u001b[1mrun\u001b(B\u001b[m    \u001b[34m\u001b[1msrv\u001b(B\u001b[m    \u001b[34m\u001b[1mtmp\u001b(B\u001b[m    \u001b[34m\u001b[1mvar\u001b(B\u001b[m                                "]
[36.737183, "o", "        \u001b[K\r\n/ # exit\u001b[K\r\n$ more ./make-certs.demo8.sh\u001b[K\r\n#!/bin/sh\u001b[K\r\n\u001b[K\r\n[ -f ca-key.pem ] || openssl genrsa -out ca-key.pem 4096                                           \u001b[K\r\nopenssl req -new -x509 -days 365 -subj \"/CN=Local CA\" -key ca-key.pem -sha256 -out ca.pem          \u001b[K\r\n[ -f reg-key.pem ] || openssl genrsa -out reg-key.pem 4096                                         \u001b[K\r\n[ -f reg.csr ] || openssl req -new -subj \"/CN=Registry\" -key reg-key.pem -out reg.csr              \u001b[K\r\necho \"subjectAltName = DNS:hub-cache,DNS:gitlab-cache,DNS:registry.gitlab.com\" >reg.ext            \u001b[K\r\nopenssl x509 -req -days 365 -in reg.csr -extfile reg.ext -CA ca.pem -CAkey ca-key.pem -CAcreateseria\u001b[21;1Hl -out reg.pem\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n$\u001b[K\u001b[C\u001b[?12l\u001b[?25h"]
[36.738309, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:10 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h"]
[38.359663, "o", "./make-certs.demo8.sh"]
[39.143228, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[39.182363, "o", "\u001b[1;25r\u001b[2S\u001b[23dSignature ok\r\nsubject=CN = Registry\u001b[1;26r\u001b[25;1H"]
[39.182664, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[AGetting CA Private Key\u001b[1;26r\u001b[25;1H"]
[39.197237, "o", "$ "]
[40.814816, "o", "1"]
[41.485266, "o", "\b\u001b[K"]
[42.016552, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[42.016981, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  206,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash-Z 1:vi*                                                 \"bmitch-t490\" 18:10 10-May-20\u001b(B\u001b[m\u001b[8;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[42.90359, "o", "\u001b[25;85H7\u001b[9;1H"]
[43.111088, "o", "\u001b[25;85H8\u001b[10;1H"]
[44.592761, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m                                                                                            \u001b[30m\u001b[43m[0/0]\u001b[39m\u001b[49m\u001b[2;1H\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose."]
[44.592886, "o", "demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  208,1         98%\u001b[K\u001b[10;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[44.594042, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:bash-Z 1:[tmux]*                                             \"bmitch-t490\" 18:10 10-May-20\u001b(B\u001b[m\u001b[10;1H\u001b[?12l\u001b[?25h"]
[44.822952, "o", "\u001b[30m\u001b[43mm\r\u001b(B\u001b[m"]
[45.095217, "o", "\u001b[30m\u001b[43mmore docker-compose.demo8.yml                                                                       \u001b[11;1Hd\r\u001b(B\u001b[m"]
[45.191547, "o", "\u001b[A\u001b[30m\u001b[43mm\u001b[39m\u001b[49more docker-compose.demo8.yml                                                                       \u001b[11;1Hd\u001b[10;1H\u001b[30m\u001b[43mmore docker-compose.demo8.yml \b\u001b(B\u001b[m"]
[46.21497, "o", "\u001b]52;;bW9yZSBkb2NrZXItY29tcG9zZS5kZW1vOC55bWwK\u0007\r\u001b[?1006h\u001b[?1000h"]
[46.217332, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[46.217425, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  208,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash-Z 1:vi*                                                 \"bmitch-t490\" 18:10 10-May-20\u001b(B\u001b[m\u001b[10;1H\u001b[?12l\u001b[?25h"]
[47.833217, "o", "\u001b[?25l\u001b[Hgitlab-cache:5000/sudo-bmitch/demo:debian\u001b[K\r\n/ # more ./make-certs.demo8.sh\u001b[K\r\nmore: ./make-certs.demo8.sh: No such file or directory                                             \u001b[K\r\n/ # ls\u001b[K\r\n\u001b[34m\u001b[1mbin\u001b(B\u001b[m    \u001b[34m\u001b[1mdev\u001b(B\u001b[m    \u001b[34m\u001b[1mhome\u001b(B\u001b[m   \u001b[34m\u001b[1mmedia\u001b(B\u001b[m  \u001b[34m\u001b[1mopt\u001b(B\u001b[m    \u001b[34m\u001b[1mroot\u001b(B\u001b[m   \u001b[34m\u001b[1msbin\u001b(B\u001b[m   \u001b[34m\u001b[1msys\u001b(B\u001b[m    \u001b[34m\u001b[1musr\u001b(B\u001b[m                                        \u001b[K\r\n\u001b[34m\u001b[1mcerts\u001b(B\u001b[m  \u001b[34m\u001b[1metc\u001b(B\u001b[m    \u001b[34m\u001b[1mlib\u001b(B\u001b[m    \u001b[34m\u001b[1mmnt\u001b(B\u001b[m    \u001b[34m\u001b[1mproc\u001b(B\u001b[m   \u001b[34m\u001b[1mrun\u001b(B\u001b[m    \u001b[34m\u001b[1msrv\u001b(B\u001b[m    \u001b[34m\u001b[1mtmp\u001b(B\u001b[m    \u001b[34m\u001b[1mvar\u001b(B\u001b[m                                        \u001b[K\r\n/ # exit\u001b[K\r\n$ more ./make-certs.demo8.sh\u001b[K\r\n#!/bin/sh\u001b[K\r\n\u001b[K\r\n[ -f ca-key.pem ] || openssl genrsa -out ca-key.pem 4096                                           \u001b[K\r\nopenssl req -new -x509 -days 365 -subj \"/CN=Local CA\" -key ca-key.pem -sha256 -out ca.pem          \u001b[K\r\n[ -f reg-key.pem ] || openssl genrsa -out reg-key.pem 4096          "]
[47.833618, "o", "                               \u001b[K\r\n[ -f reg.csr ] || openssl req -new -subj \"/CN=Registry\" -key reg-key.pem -out reg.csr              \u001b[K\r\necho \"subjectAltName = DNS:hub-cache,DNS:gitlab-cache,DNS:registry.gitlab.com\" >reg.ext            \u001b[K\r\nopenssl x509 -req -days 365 -in reg.csr -extfile reg.ext -CA ca.pem -CAkey ca-key.pem -CAcreateseria\u001b[17;1Hl -out reg.pem\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n$ ./make-certs.demo8.sh\u001b[K\r\nSignature ok\u001b[K\r\nsubject=CN = Registry\u001b[K\r\nGetting CA Private Key\u001b[K\r\n$\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:10 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[48.912404, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[24;3Hmore docker-compose.demo8.yml\u001b[1;26r\u001b[25;1H"]
[48.91525, "o", "\u001b[1;25r\u001b[22S\u001b[3dversion: '3.7'\u001b[5;1Hnetworks:\r\n  cache:\r\n    name: cache\r\n    external: true\u001b[10;1Hvolumes:\r\n  hub-cache:\r\n    name: hub-cache\r\n  gitlab-cache:\r\n    name: gitlab-cache\u001b[16;1Hservices:\r\n  builder:\r\n    image: docker:dind\r\n    command: [\"--registry-mirror\", \"https://hub-cache:5000\", \"--debug\"]\r\n    privileged: true\r\n    restart: unless-stopped\r\n    env_file: .env\r\n    networks:\r\n    - cache\u001b[1;26r\u001b[25;1H\u001b[1;25r\u001b[2S\u001b[23d    volumes:\r\n    - type: bind\u001b[1;26r\u001b[25;1H\u001b[7m--More--(19%)"]
[48.915545, "o", "\u001b(B\u001b[m"]
[51.499592, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:more*Z 1:vi-                                                 \"bmitch-t490\" 18:10 10-May-20\u001b(B\u001b[m\u001b[25;14H\u001b[?12l\u001b[?25h"]
[51.499888, "o", "\u001b[1;25r\u001b[12S\u001b[13d      source: ./ca.pem\r\n      target: /etc/docker/certs.d/hub-cache:5000/ca.crt\r\n      read_only: true\r\n    - type: bind\r\n      source: ./ca.pem\r\n      target: /etc/docker/certs.d/gitlab-cache/ca.crt\r\n      read_only: true\r\n    - type: bind\r\n      source: ./ca.pem\r\n      target: /etc/docker/certs.d/registry.gitlab.com/ca.crt\r\n      read_only: true\u001b[1;26r\u001b[25;1H\u001b[1;25r\u001b[12S\u001b[13d  hub-cache:\r\n    image: registry:2\r\n    restart: unless-stopped\r\n    env_file: .env\r\n    environment:\r\n      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry\r\n      REGISTRY_PROXY_REMOTEURL: https://registry-1.docker.io\r\n      REGISTRY_PROXY_USERNAME: $DOCKER_USER\r\n      REGISTRY_PROXY_PASSWORD: $DOCKER_TOKEN\r\n      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem\r\n      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem\r\n    networks:\r\n\u001b[7m--More--(56%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[52.966658, "o", "\r    - cache\u001b[K\u001b[1;25r\u001b[25;1H\n\u001b[7m--More--(57%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[53.174904, "o", "\r    volumes:\u001b[K\u001b[1;25r\u001b[25;1H\n\u001b[7m--More--(58%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[53.358852, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A    - type: bind\r\n\u001b[7m--More--(58%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[53.534788, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      source: .\r\n\u001b[7m--More--(59%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[53.707813, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      target: /host\u001b[1;26r\u001b[25;1H\u001b[7m--More--(60%)\u001b(B\u001b[m"]
[53.902575, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      read_only: true\r\n\u001b[7m--More--(61%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[54.07074, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A    - type: volume\r\n\u001b[7m--More--(62%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[54.262665, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      source: hub-cache\r\n\u001b[7m--More--(63%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[54.446839, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      target: /var/lib/registry\r\n\u001b[7m--More--(65%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[54.6306, "o", "\r\u001b[K\u001b[1;25r\u001b[25;1H\n\u001b[7m--More--(65%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[56.278824, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A  gitlab-cache:\r\n\u001b[7m--More--(66%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[57.276957, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A    image: registry:2\r\n\u001b[7m--More--(67%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[57.779649, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A    restart: unless-stopped\r\n\u001b[7m--More--(68%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[57.810319, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A    environment:\r\n\u001b[7m--More--(69%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[57.840931, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry\r\n\u001b[7m--More--(72%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[57.872305, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      REGISTRY_PROXY_REMOTEURL: https://registry.gitlab.com\r\n\u001b[7m--More--(75%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[57.900715, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      REGISTRY_PROXY_USERNAME: $GITLAB_USER\r\n\u001b[7m--More--(77%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[57.931782, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      REGISTRY_PROXY_PASSWORD: $GITLAB_TOKEN\r\n\u001b[7m--More--(80%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[57.961875, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      REGISTRY_HTTP_ADDR: \":443\"\r\n\u001b[7m--More--(81%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[57.991777, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem\r\n\u001b[7m--More--(84%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.023449, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem\r\n\u001b[7m--More--(86%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.054098, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A    networks:\r\n\u001b[7m--More--(87%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.084611, "o", "\r      cache:\u001b[K\u001b[1;25r\u001b[25;1H\n\u001b[7m--More--(87%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.115145, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A        aliases:\r\n\u001b[7m--More--(88%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.145475, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A        - registry.gitlab.com\r\n\u001b[7m--More--(90%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.175785, "o", "\r    dns:\u001b[K\u001b[1;25r\u001b[25;1H\n\u001b[7m--More--(90%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.205932, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A    - 8.8.8.8\r\n\u001b[7m--More--(91%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.236781, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A    - 8.8.4.4\r\n\u001b[7m--More--(91%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.267506, "o", "\r    volumes:\u001b[K\u001b[1;25r\u001b[25;1H\n\u001b[7m--More--(92%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.297977, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A    - type: bind\r\n\u001b[7m--More--(93%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.328099, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      source: .\r\n\u001b[7m--More--(94%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.358174, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      target: /host\r\n\u001b[7m--More--(95%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.38871, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      read_only: true\r\n\u001b[7m--More--(96%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.418258, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A    - type: volume\r\n\u001b[7m--More--(97%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[58.448793, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      source: gitlab-cache\r\n\u001b[7m--More--(98%)\u001b[1;26r\u001b[25;14H\u001b(B\u001b[m"]
[60.07127, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[A      target: /var/lib/registry\u001b[1;26r\u001b[25;1H$ "]
[60.072825, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:10 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h"]
[61.352501, "o", "\u001b[?25l\u001b[H    restart: unless-stopped                                                                  \u001b[30m\u001b[43m[0/587]\u001b[2;1H\u001b[39m\u001b[49m    environment:\u001b[K\r\n      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry                                 \u001b[K\r\n      REGISTRY_PROXY_REMOTEURL: https://registry.gitlab.com                                        \u001b[K\r\n      REGISTRY_PROXY_USERNAME: $GITLAB_USER\u001b[K\r\n      REGISTRY_PROXY_PASSWORD: $GITLAB_TOKEN\u001b[K\r\n      REGISTRY_HTTP_ADDR: \":443\"\u001b[K\r\n      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem\u001b[K\r\n      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem\u001b[K\r\n    networks:\u001b[K\r\n      cache:\u001b[K\r\n        aliases:\u001b[K\r\n        - registry.gitlab.com\u001b[K\r\n    dns:\u001b[K\r\n    - 8.8.8.8\u001b[K\r\n    - 8.8.4.4\u001b[K\r\n    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n      target: /host\u001b[K\r\n      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n      source: gitlab-cache\u001b[K\r\n      target: /var/lib/registry\u001b[K\r\n$\u001b[K\u001b[C\u001b[?12l\u001b[?25h"]
[61.353809, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:[tmux]*Z 1:vi-                                               \"bmitch-t490\" 18:10 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h"]
[61.791478, "o", "\u001b[24;32H"]
[62.291263, "o", "\u001b[23;27H"]
[62.32161, "o", "\u001b[22;19H"]
[62.352069, "o", "\u001b[21;22H"]
[62.382331, "o", "\u001b[20;20H"]
[62.412551, "o", "\u001b[19;16H"]
[62.440992, "o", "\u001b[18;17H"]
[62.471397, "o", "\u001b[17;13H"]
[62.502679, "o", "\u001b[16;14H"]
[62.531304, "o", "\u001b[A"]
[62.561094, "o", "\u001b[14;9H"]
[62.591999, "o", "\u001b[13;30H"]
[62.839158, "o", "\u001b[12;17H"]
[63.039171, "o", "\u001b[11;13H"]
[63.231213, "o", "\u001b[10;14H"]
[63.423119, "o", "\r\n"]
[63.909895, "o", "\r\n"]
[64.223523, "o", "\u001b[30m\u001b[43m \r\u001b(B\u001b[m"]
[64.459473, "o", "\u001b[30m\u001b[43m        aliases:                                                                                    \u001b[13;1H \r\u001b(B\u001b[m"]
[64.635787, "o", "\u001b[30m\u001b[43m        - registry.gitlab.com                                                                       \u001b[14;1H \r\u001b(B\u001b[m"]
[65.444054, "o", "\u001b[30m\u001b[43m    dns:                                                                                            \u001b[15;1H \r\u001b(B\u001b[m"]
[65.631348, "o", "\u001b[30m\u001b[43m    - 8.8.8.8                                                                                       \u001b[16;1H \r\u001b(B\u001b[m"]
[65.823167, "o", "\u001b[30m\u001b[43m    - 8.8.4.4                                                                                       \u001b[17;1H \r\u001b(B\u001b[m"]
[67.680405, "o", "\u001b[?25l\u001b[H    restart: unless-stopped\u001b[K\r\n    environment:\u001b[K\r\n      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry                                 \u001b[K\r\n      REGISTRY_PROXY_REMOTEURL: https://registry.gitlab.com                                        \u001b[K\r\n      REGISTRY_PROXY_USERNAME: $GITLAB_USER\u001b[K\r\n      REGISTRY_PROXY_PASSWORD: $GITLAB_TOKEN\u001b[K\r\n      REGISTRY_HTTP_ADDR: \":443\"\u001b[K\r\n      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem                                                 \u001b[K\r\n      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem\u001b[K\r\n    networks:\u001b[K\r\n      cache:\u001b[K\r\n        aliases:\u001b[K\r\n        - registry.gitlab.com\u001b[K\r\n    dns:\u001b[K\r\n    - 8.8.8.8\u001b[K\r\n    - 8.8.4.4\u001b[K\r\n    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n      target: /host\u001b[K\r\n      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n      source: gitlab-cache\u001b[K\r\n      target: /var/lib/registry\u001b[K\r\n$\u001b[K\u001b[C\u001b[?12l\u001b[?25h"]
[67.681718, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:10 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h"]
[68.54501, "o", "\u001b[?25l\u001b[H    image: registry:2                                                                       \u001b[30m\u001b[43m[23/587]\u001b[2;1H\u001b[39m\u001b[49m    restart: unless-stopped\u001b[K\r\n    env_file: .env                                                                                 \u001b[K\r\n    environment:                                                                                   \u001b[K\r\n      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry                                 \u001b[K\r\n      REGISTRY_PROXY_REMOTEURL: https://registry-1.docker.io                                       \u001b[K\r\n      REGISTRY_PROXY_USERNAME: $DOCKER_USER\u001b[K\r\n      REGISTRY_PROXY_PASSWORD: $DOCKER_TOKEN\u001b[K\r\n      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem\u001b[K\r\n      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem\u001b[K\r\n    networks:\u001b[K\r\n    - cache\u001b[K\r\n    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n      target: /host\u001b[K\r\n      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n      source: hub-cache\u001b[K\r\n      target: /var/lib/registry\u001b[K\r\n\u001b[K\r\n  gi"]
[68.545352, "o", "tlab-cache:\u001b[K\r\n    image: registry:2\u001b[K\r\n    restart: unless-stopped\u001b[K\r\n    environment:\u001b[K\u001b[?12l\u001b[?25h"]
[68.546434, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:[tmux]*Z 1:vi-                                               \"bmitch-t490\" 18:10 10-May-20\u001b(B\u001b[m\u001b[25;17H\u001b[?12l\u001b[?25h"]
[69.648089, "o", "\u001b[1;94H\u001b[30m\u001b[43m46\u001b[3G\u001b[39m\u001b[49mbu\u001b[Clder\u001b[2C          \u001b[2;5Himage: docker:dind     \u001b[3;5Hcommand: [\"--registry-mirror\",\u001b[C\"https://hub-cache:5000\",\u001b[C\"--debug\"]\u001b[4;5Hprivileg\u001b[Cd: true\u001b[5;5Hrestart: unless-stopped                     \u001b[C                 \u001b[6;5Henv_file: .env             \u001b[C                            \u001b[7;5Hnetworks:                 \u001b[C            \u001b[8;5H-\u001b[Ccache                   \u001b[C             \u001b[9;5Hvolumes:                        \u001b[C             \u001b[10;5H-\u001b[Ctype: bind            \u001b[C                 \u001b[11;5H  sou\u001b[Cce\u001b[2C./ca.pem\u001b[12;5H \u001b[Ct\u001b[Crg\u001b[Ct:\u001b[C/etc/docker/certs.d/hub-cache:5000/ca.crt\u001b[13;5H  read_only:\u001b[Ctrue\u001b[15;16H/ca.pem\u001b[16;16Hetc/docker/certs.d/gitlab-cache/ca.crt\u001b[18;13Hbind  \u001b[19;15H./ca.pem \u001b[20;16Hetc\u001b[Cdocker/certs.d/registry.gitlab.com/ca.crt\u001b[21;7Hread_only:\u001b[Ctrue\u001b[22;3H             \u001b[23;3Hhub-cache:         \u001b[24;5Himage: registry:2      \u001b[25;5Hrestart: unless-stopped"]
[70.399348, "o", "\u001b[24;22H"]
[70.899371, "o", "\u001b[23;13H"]
[70.926082, "o", "\u001b[22;1H"]
[70.956587, "o", "\u001b[21;22H"]
[70.989534, "o", "\u001b[20;61H"]
[71.247188, "o", "\u001b[19;23H"]
[71.471186, "o", "\u001b[18;17H"]
[71.735299, "o", "\r\n"]
[73.663559, "o", "\u001b[30m\u001b[43m \r\u001b(B\u001b[m"]
[73.895396, "o", "\u001b[30m\u001b[43m      source: ./ca.pem                                                                              \u001b[20;1H \r\u001b(B\u001b[m"]
[74.095283, "o", "\u001b[30m\u001b[43m      target: /etc/docker/certs.d/registry.gitlab.com/ca.crt                                        \u001b[21;1H \r\u001b(B\u001b[m"]
[74.263491, "o", "\u001b[30m\u001b[43m      read_only: true                                                                               \u001b[22;1H \r\u001b(B\u001b[m"]
[77.976492, "o", "\u001b[?25l\u001b[H    restart: unless-stopped\u001b[K\r\n    environment:\u001b[K\r\n      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry                                 \u001b[K\r\n      REGISTRY_PROXY_REMOTEURL: https://registry.gitlab.com                                        \u001b[K\r\n      REGISTRY_PROXY_USERNAME: $GITLAB_USER\u001b[K\r\n      REGISTRY_PROXY_PASSWORD: $GITLAB_TOKEN\u001b[K\r\n      REGISTRY_HTTP_ADDR: \":443\"\u001b[K\r\n      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem                                                 \u001b[K\r\n      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem\u001b[K\r\n    networks:\u001b[K\r\n      cache:\u001b[K\r\n        aliases:\u001b[K\r\n        - registry.gitlab.com\u001b[K\r\n    dns:\u001b[K\r\n    - 8.8.8.8\u001b[K\r\n    - 8.8.4.4\u001b[K\r\n    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n      target: /host\u001b[K\r\n      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n      source: gitlab-cache\u001b[K\r\n      target: /var/lib/registry\u001b[K\r\n$\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:[tmux]*Z 1:vi-                                               \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[25;3"]
[77.976782, "o", "H\u001b[?12l\u001b[?25h"]
[77.97795, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h"]
[80.192736, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[80.192847, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  208,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash-Z 1:vi*                                                 \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[10;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[80.98374, "o", "\u001b[25;85H9\u001b[11;1H"]
[82.249016, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m                                                                                            \u001b[30m\u001b[43m[0/0]\u001b[39m\u001b[49m\u001b[2;1H\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose."]
[82.249143, "o", "demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  209,1         98%\u001b[K\u001b[11;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[82.250357, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:bash-Z 1:[tmux]*                                             \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[11;1H\u001b[?12l\u001b[?25h"]
[82.663762, "o", "\u001b[30m\u001b[43md\r\u001b(B\u001b[m"]
[82.927664, "o", "\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo8.yml up -d                                                    \u001b[12;1Hd\r\u001b(B\u001b[m"]
[83.039328, "o", "\u001b[A\u001b[30m\u001b[43md\u001b[39m\u001b[49mocker-compose -f docker-compose.demo8.yml up -d                                                    \u001b[12;1Hd\u001b[11;1H\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo8.yml up -d \b\u001b(B\u001b[m"]
[83.863425, "o", "\r\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo8.yml up -d\u001b[39m\u001b[49m \b\b"]
[84.230874, "o", "\u001b]52;;ZG9ja2VyLWNvbXBvc2UgLWYgZG9ja2VyLWNvbXBvc2UuZGVtbzgueW1sIHVwIC1k\u0007\r\u001b[?1006h\u001b[?1000h"]
[84.233205, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[84.233489, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  209,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash-Z 1:vi*                                                 \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[11;1H\u001b[?12l\u001b[?25h"]
[84.800435, "o", "\u001b[?25l\u001b[H    restart: unless-stopped\u001b[K\r\n    environment:\u001b[K\r\n      REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry                                 \u001b[K\r\n      REGISTRY_PROXY_REMOTEURL: https://registry.gitlab.com                                        \u001b[K\r\n      REGISTRY_PROXY_USERNAME: $GITLAB_USER\u001b[K\r\n      REGISTRY_PROXY_PASSWORD: $GITLAB_TOKEN\u001b[K\r\n      REGISTRY_HTTP_ADDR: \":443\"\u001b[K\r\n      REGISTRY_HTTP_TLS_CERTIFICATE: /host/reg.pem                                                 \u001b[K\r\n      REGISTRY_HTTP_TLS_KEY: /host/reg-key.pem\u001b[K\r\n    networks:\u001b[K\r\n      cache:\u001b[K\r\n        aliases:\u001b[K\r\n        - registry.gitlab.com\u001b[K\r\n    dns:\u001b[K\r\n    - 8.8.8.8\u001b[K\r\n    - 8.8.4.4\u001b[K\r\n    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n      target: /host\u001b[K\r\n      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n      source: gitlab-cache\u001b[K\r\n      target: /var/lib/registry\u001b[K\r\n$\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[25;3"]
[84.800774, "o", "H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[86.248359, "o", "docker-compose -f docker-compose.demo8.yml up -d"]
[86.791254, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[87.235225, "o", "\u001b[1;25r\u001b[7S\u001b[18d\u001b[33mWARNING\u001b[39m: The Docker Engine you're using is running in swarm mode.\u001b[20;1HCompose does not use swarm mode to deploy services to multiple nodes in a swarm. All containers will be scheduled on the current node.\u001b[23;1HTo deploy your application across the swarm, use `docker stack deploy`.\u001b[1;26r\u001b[25;1H"]
[87.277894, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[Aexample_hub-cache_1 is up-to-date\u001b[1;26r\u001b[25;1H"]
[87.278104, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[ARecreating example_builder_1 ... \u001b[1;26r\u001b[25;1H"]
[87.278903, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[ARecreating example_gitlab-cache_1 ... \u001b[1;26r\u001b[25;1H"]
[87.811841, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[25;1H\u001b[?12l\u001b[?25h"]
[88.209116, "o", "\u001b[A\u001b[KRecreating example_gitlab-cache_1 ... \u001b[32mdone\r\n\u001b(B\u001b[m"]
[88.316865, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[88.31703, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  209,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[11;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[88.993252, "o", "\u001b[25;84H10\u001b[12;1H"]
[89.755587, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m                                                                                            \u001b[30m\u001b[43m[0/0]\u001b[39m\u001b[49m\u001b[2;1H\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose."]
[89.755678, "o", "demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  210,1         98%\u001b[K\u001b[12;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[89.755868, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:[tmux]*                                   \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[12;1H\u001b[?12l\u001b[?25h"]
[90.010963, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:bash-Z 1:[tmux]*                                             \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[12;1H\u001b[?12l\u001b[?25h"]
[90.083295, "o", "\u001b[30m\u001b[43md\r\u001b(B\u001b[m"]
[90.387332, "o", "\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo8.yml exec builder sh                                          \u001b[13;1H#\r\u001b(B\u001b[m"]
[90.499248, "o", "\u001b[A\u001b[30m\u001b[43md\u001b[39m\u001b[49mocker-compose -f docker-compose.demo8.yml exec builder sh                                          \u001b[13;1H\u001b[31m\u001b[1m#\u001b[12;1H\u001b(B\u001b[m\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo8.yml exec builder sh \b\u001b(B\u001b[m"]
[91.122936, "o", "\u001b]52;;ZG9ja2VyLWNvbXBvc2UgLWYgZG9ja2VyLWNvbXBvc2UuZGVtbzgueW1sIGV4ZWMgYnVpbGRlciBzaAo=\u0007\r\u001b[?1006h\u001b[?1000h"]
[91.123415, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[91.123487, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  210,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash-Z 1:vi*                                                 \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[12;1H\u001b[?12l\u001b[?25h"]
[91.843614, "o", "\u001b[?25l\u001b[H        aliases:\u001b[K\r\n        - registry.gitlab.com\u001b[K\r\n    dns:\u001b[K\r\n    - 8.8.8.8\u001b[K\r\n    - 8.8.4.4\u001b[K\r\n    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n      target: /host\u001b[K\r\n      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n      source: gitlab-cache\u001b[K\r\n      target: /var/lib/registry\u001b[K\r\n$ docker-compose -f docker-compose.demo8.yml up -d                                                 \u001b[K\r\n\u001b[33mWARNING\u001b[39m: The Docker Engine you're using is running in swarm mode.                                  \u001b[K\r\n\u001b[K\r\nCompose does not use swarm mode to deploy services to multiple nodes in a swarm. All containers will be scheduled on the current node.\u001b[K\r\n\u001b[K\r\nTo deploy your application across the swarm, use `docker stack deploy`.                            \u001b[K\r\n\u001b[K\r\nexample_hub-cache_1 is up-to-date\u001b[K\r\nRecreating example_builder_1      ... \u001b[32mdone\u001b[39m\u001b[K\r\nRecreating example_gitlab-cache_1 ... \u001b[32mdone\u001b[39m\u001b[K\r\n$\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                               "]
[91.843769, "o", "  \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[92.896207, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[24;3Hdocker-compose -f docker-compose.demo8.yml exec builder sh\u001b[1;26r\u001b[25;1H"]
[93.418418, "o", "/ # "]
[93.418725, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[25;5H\u001b[?12l\u001b[?25h"]
[93.41931, "o", "\r/ # \u001b[1;25r\u001b[25;5H\u001b[K\u001b[1;26r\u001b[25;5H"]
[94.208983, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[94.209233, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  210,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[12;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[94.84407, "o", "\u001b[25;85H1\u001b[13;1H"]
[95.012013, "o", "\u001b[25;85H2\u001b[14;1H"]
[95.740237, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m                                                                                            \u001b[30m\u001b[43m[0/0]\u001b[39m\u001b[49m\u001b[2;1H\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose."]
[95.740278, "o", "demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  212,1         98%\u001b[K\u001b[14;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[96.108247, "o", "\u001b[30m\u001b[43md\u001b[?25l\u001b[26;1H\u001b[42m[preso] 0:docker-compose-Z 1:[tmux]*                                   \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[14;1H\u001b[?12l\u001b[?25h"]
[96.347429, "o", "\u001b[30m\u001b[43mdocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                       \u001b[15;1H#\r\u001b(B\u001b[m"]
[96.455481, "o", "\u001b[A\u001b[30m\u001b[43md\u001b[39m\u001b[49mocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                       \u001b[15;1H\u001b[31m\u001b[1m#\u001b[14;1H\u001b(B\u001b[m\u001b[30m\u001b[43mdocker image pull registry.gitlab.com/sudo-bmitch/demo:debian \b\u001b(B\u001b[m"]
[97.54281, "o", "\u001b]52;;ZG9ja2VyIGltYWdlIHB1bGwgcmVnaXN0cnkuZ2l0bGFiLmNvbS9zdWRvLWJtaXRjaC9kZW1vOmRlYmlhbgo=\u0007\r\u001b[?1006h\u001b[?1000h"]
[97.545637, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[97.54573, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  212,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[14;1H\u001b[?12l\u001b[?25h"]
[98.36432, "o", "\u001b[?25l\u001b[H        - registry.gitlab.com\u001b[K\r\n    dns:\u001b[K\r\n    - 8.8.8.8\u001b[K\r\n    - 8.8.4.4\u001b[K\r\n    volumes:\u001b[K\r\n    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n      target: /host\u001b[K\r\n      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n      source: gitlab-cache\u001b[K\r\n      target: /var/lib/registry\u001b[K\r\n$ docker-compose -f docker-compose.demo8.yml up -d                                                 \u001b[K\r\n\u001b[33mWARNING\u001b[39m: The Docker Engine you're using is running in swarm mode.                                  \u001b[K\r\n\u001b[K\r\nCompose does not use swarm mode to deploy services to multiple nodes in a swarm. All containers will be scheduled on the current node.\u001b[K\r\n\u001b[K\r\nTo deploy your application across the swarm, use `docker stack deploy`.                            \u001b[K\r\n\u001b[K\r\nexample_hub-cache_1 is up-to-date\u001b[K\r\nRecreating example_builder_1      ... \u001b[32mdone\u001b[39m\u001b[K\r\nRecreating example_gitlab-cache_1 ... \u001b[32mdone\u001b[39m\u001b[K\r\n$ docker-compose -f docker-compose.demo8.yml exec builder sh                                       \u001b[K\r\n/ "]
[98.364367, "o", "#\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[25;5H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[99.548712, "o", "docker image pull regis\u001b[1;25r\u001b[25;1H\n\u001b[24;28Htry.gitlab.com/sudo-bmitch/demo:debian"]
[99.548859, "o", "\u001b[1;26r\u001b[25;1H"]
[100.098227, "o", "\u001b[1;25r\u001b[4S\u001b[21ddebian: Pulling from sudo-bmitch/demo\r\nDigest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16\r\nStatus: Image is up to date for registry.gitlab.com/sudo-bmitch/demo:debian\r\nregistry.gitlab.com/sudo-bmitch/demo:debian\u001b[1;26r\u001b[25;1H"]
[100.101011, "o", "/ # "]
[102.264864, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[102.265202, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  212,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[14;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[104.095779, "o", "\u001b[25;85H3\u001b[15;1H"]
[104.57598, "o", "\u001b[25;85H4\u001b[16;1H"]
[105.516751, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m                                                                                            \u001b[30m\u001b[43m[0/0]\u001b[39m\u001b[49m\u001b[2;1H\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose."]
[105.516896, "o", "demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  214,1         98%\u001b[K\u001b[16;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[105.517367, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:[tmux]*                                   \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[16;1H\u001b[?12l\u001b[?25h"]
[105.911678, "o", "\u001b[30m\u001b[43md\r\u001b(B\u001b[m"]
[106.175454, "o", "\u001b[30m\u001b[43mdocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                       \u001b[17;1He\r\u001b(B\u001b[m"]
[106.295492, "o", "\u001b[A\u001b[30m\u001b[43md\u001b[39m\u001b[49mocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                       \u001b[17;1He\u001b[16;1H\u001b[30m\u001b[43mdocker image push registry.gitlab.com/sudo-bmitch/demo:debian \b\u001b(B\u001b[m"]
[106.950804, "o", "\u001b]52;;ZG9ja2VyIGltYWdlIHB1c2ggcmVnaXN0cnkuZ2l0bGFiLmNvbS9zdWRvLWJtaXRjaC9kZW1vOmRlYmlhbgo=\u0007\r\u001b[?1006h\u001b[?1000h"]
[106.953227, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[106.95353, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  214,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[16;1H\u001b[?12l\u001b[?25h"]
[107.912945, "o", "\u001b[?25l\u001b[H    - type: bind\u001b[K\r\n      source: .\u001b[K\r\n      target: /host\u001b[K\r\n      read_only: true\u001b[K\r\n    - type: volume\u001b[K\r\n      source: gitlab-cache\u001b[K\r\n      target: /var/lib/registry\u001b[K\r\n$ docker-compose -f docker-compose.demo8.yml up -d                                                 \u001b[K\r\n\u001b[33mWARNING\u001b[39m: The Docker Engine you're using is running in swarm mode.                                  \u001b[K\r\n\u001b[K\r\nCompose does not use swarm mode to deploy services to multiple nodes in a swarm. All containers will be scheduled on the current node.\u001b[K\r\n\u001b[K\r\nTo deploy your application across the swarm, use `docker stack deploy`.                            \u001b[K\r\n\u001b[K\r\nexample_hub-cache_1 is up-to-date\u001b[K\r\nRecreating example_builder_1      ... \u001b[32mdone\u001b[39m\u001b[K\r\nRecreating example_gitlab-cache_1 ... \u001b[32mdone\u001b[39m\u001b[K\r\n$ docker-compose -f docker-compose.demo8.yml exec builder sh                                       \u001b[K\r\n/ # docker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                  \u001b[K"]
[107.91329, "o", "\r\ndebian: Pulling from sudo-bmitch/demo\u001b[K\r\nDigest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16                    \u001b[K\r\nStatus: Image is up to date for registry.gitlab.com/sudo-bmitch/demo:debian                        \u001b[K\r\nregistry.gitlab.com/sudo-bmitch/demo:debian\u001b[K\r\n/ #\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[25;5H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[109.02472, "o", "docker image push registry.gitlab.com/sudo-bmitch/demo:debian"]
[109.025061, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[109.05181, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[AThe push refers to repository [registry.gitlab.com/sudo-bmitch/demo]\u001b[1;26r\u001b[25;1H"]
[109.156644, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[Ae40d297cf5f8: Preparing \u001b[1;26r\u001b[25;1H"]
[109.527072, "o", "\u001b[A\u001b[Ke40d297cf5f8: Layer already exists \r\n"]
[109.802273, "o", "\u001b[1;25r\u001b[3S\u001b[22d[DEPRECATION NOTICE] registry v2 schema1 support will be removed in an upcoming release. Please contact admins of the registry.gitlab.com registry NOW to avoid future disruption. More information at https://docs.docker.com/registry/spec/deprecated-schema-v1/\u001b[1;26r\u001b[25;1H"]
[110.023874, "o", "\u001b[1;25r\u001b[4S\u001b[21derrors:\r\ndenied: requested access to the resource is denied\r\nunauthorized: authentication required\u001b[1;26r\u001b[25;1H"]
[110.027348, "o", "/ # "]
[113.376824, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[113.377156, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  214,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[16;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[114.511922, "o", "\u001b[25;85H5\u001b[17;1H"]
[114.72722, "o", "\u001b[25;85H6\u001b[18;1H"]
[114.975357, "o", "\u001b[25;85H7\u001b[19;1H"]
[115.905087, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m                                                                                            \u001b[30m\u001b[43m[0/0]\u001b[39m\u001b[49m\u001b[2;1H\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose."]
[115.905223, "o", "demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  217,1         98%\u001b[K\u001b[19;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[115.906557, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:[tmux]*                                   \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[19;1H\u001b[?12l\u001b[?25h"]
[117.079751, "o", "\u001b[30m\u001b[43md\r\u001b(B\u001b[m"]
[117.271611, "o", "\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                        \u001b[20;1Hd\r\u001b(B\u001b[m"]
[117.368003, "o", "\u001b[A\u001b[30m\u001b[43md\u001b[39m\u001b[49mocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                        \u001b[20;1Hd\u001b[19;1H\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo8.yml stop gitlab-cache \b\u001b(B\u001b[m"]
[118.479488, "o", "\r\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo8.yml stop gitlab-cache\u001b[39m\u001b[49m \b\b"]
[118.931337, "o", "\u001b]52;;ZG9ja2VyLWNvbXBvc2UgLWYgZG9ja2VyLWNvbXBvc2UuZGVtbzgueW1sIHN0b3AgZ2l0bGFiLWNhY2hl\u0007\r\u001b[?1006h\u001b[?1000h"]
[118.931862, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[118.931886, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  217,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[19;1H\u001b[?12l\u001b[?25h"]
[119.584716, "o", "\u001b[?25l\u001b[HCompose does not use swarm mode to deploy services to multiple nodes in a swarm. All containers will be scheduled on the current node.\u001b[K\r\n\u001b[K\r\nTo deploy your application across the swarm, use `docker stack deploy`.                            \u001b[K\r\n\u001b[K\r\nexample_hub-cache_1 is up-to-date\u001b[K\r\nRecreating example_builder_1      ... \u001b[32mdone\u001b[39m\u001b[K\r\nRecreating example_gitlab-cache_1 ... \u001b[32mdone\u001b[39m\u001b[K\r\n$ docker-compose -f docker-compose.demo8.yml exec builder sh                                       \u001b[K\r\n/ # docker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                  \u001b[K\r\ndebian: Pulling from sudo-bmitch/demo\u001b[K\r\nDigest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16                    \u001b[K\r\nStatus: Image is up to date for registry.gitlab.com/sudo-bmitch/demo:debian                        \u001b[K\r\nregistry.gitlab.com/sudo-bmitch/demo:debian\u001b[K\r\n/ # docker image push registry.gitlab.com/sudo-bmitch/demo:debian                                  \u001b[K\r\n"]
[119.585052, "o", "The push refers to repository [registry.gitlab.com/sudo-bmitch/demo]                               \u001b[K\r\ne40d297cf5f8: Layer already exists\u001b[K\r\n[DEPRECATION NOTICE] registry v2 schema1 support will be removed in an upcoming release. Please contact admins of the registry.gitlab.com registry NOW to avoid future disruption. More information at https://docs.docker.com/registry/spec/deprecated-schema-v1/                                         \u001b[K\r\nerrors:\u001b[K\r\ndenied: requested access to the resource is denied                                                 \u001b[K\r\nunauthorized: authentication required\u001b[K\r\n\u001b[K\r\n/ #\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[25;5H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[120.119678, "o", "e"]
[120.335206, "o", "x"]
[120.486996, "o", "i"]
[120.607117, "o", "t"]
[121.229069, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[121.341265, "o", "$ "]
[121.863555, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h"]
[122.224039, "o", "docker-compose -f docker-compose.demo8.yml stop gitlab-cache"]
[124.65543, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[125.076473, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[AStopping example_gitlab-cache_1 ... \u001b[1;26r\u001b[25;1H"]
[125.089896, "o", "\u001b[A\u001b[KStopping example_gitlab-cache_1 ... \u001b[32mdone\r\n\u001b(B\u001b[m"]
[125.167037, "o", "$ \u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h"]
[125.793087, "o", "\u001b[?25l\u001b[H\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec"]
[125.793193, "o", " builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n                                                                                  217,1         98%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash-Z 1:vi*                                                 \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[19;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[126.672332, "o", "\u001b[1;24r\u001b[24;1H\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[25;83H\u001b[K218,1\u001b[9C99%\u001b[1;26r\u001b[19;1H"]
[127.508045, "o", "\u001b[?25l\u001b[H                                                                                               \u001b[30m\u001b[43m[0/0]\u001b[2;1H\u001b[39m\u001b[49m## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitla"]
[127.50817, "o", "b-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n                                                                                  218,1         99%\u001b[K\u001b[19;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[127.508433, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:bash-Z 1:[tmux]*                                             \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[19;1H\u001b[?12l\u001b[?25h"]
[127.787353, "o", "\u001b[30m\u001b[43md\r\u001b(B\u001b[m"]
[128.055285, "o", "\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo8.yml exec builder sh                                          \u001b[20;1Hd\r\u001b(B\u001b[m"]
[128.159482, "o", "\u001b[A\u001b[30m\u001b[43md\u001b[39m\u001b[49mocker-compose -f docker-compose.demo8.yml exec builder sh                                          \u001b[20;1Hd\u001b[19;1H\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo8.yml exec builder sh \b\u001b(B\u001b[m"]
[128.701929, "o", "\r\u001b[30m\u001b[43mdocker-compose -f docker-compose.demo8.yml exec builder sh\u001b[39m\u001b[49m \b\b"]
[129.204038, "o", "\u001b]52;;ZG9ja2VyLWNvbXBvc2UgLWYgZG9ja2VyLWNvbXBvc2UuZGVtbzgueW1sIGV4ZWMgYnVpbGRlciBzaA==\u0007\r\u001b[?1006h\u001b[?1000h"]
[129.204878, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh            "]
[129.204908, "o", "                             \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n                                                                                  218,1         99%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash-Z 1:vi*                                                 \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[19;1H\u001b[?12l\u001b[?25h"]
[129.744618, "o", "\u001b[?25l\u001b[HTo deploy your application across the swarm, use `docker stack deploy`.                            \u001b[K\r\n\u001b[K\r\nexample_hub-cache_1 is up-to-date\u001b[K\r\nRecreating example_builder_1      ... \u001b[32mdone\u001b[39m\u001b[K\r\nRecreating example_gitlab-cache_1 ... \u001b[32mdone\u001b[39m\u001b[K\r\n$ docker-compose -f docker-compose.demo8.yml exec builder sh                                       \u001b[K\r\n/ # docker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                  \u001b[K\r\ndebian: Pulling from sudo-bmitch/demo\u001b[K\r\nDigest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16                    \u001b[K\r\nStatus: Image is up to date for registry.gitlab.com/sudo-bmitch/demo:debian                        \u001b[K\r\nregistry.gitlab.com/sudo-bmitch/demo:debian\u001b[K\r\n/ # docker image push registry.gitlab.com/sudo-bmitch/demo:debian                                  \u001b[K\r\nThe push refers to repository [registry.gitlab.com/sudo-bmitch/demo]                               \u001b[K\r\ne40d297cf5f8: Layer already exists\u001b[K\r\n["]
[129.744733, "o", "DEPRECATION NOTICE] registry v2 schema1 support will be removed in an upcoming release. Please contact admins of the registry.gitlab.com registry NOW to avoid future disruption. More information at https://docs.docker.com/registry/spec/deprecated-schema-v1/                                         \u001b[K\r\nerrors:\u001b[K\r\ndenied: requested access to the resource is denied                                                 \u001b[K\r\nunauthorized: authentication required\u001b[K\r\n\u001b[K\r\n/ # exit\u001b[K\r\n$ docker-compose -f docker-compose.demo8.yml stop gitlab-cache                                     \u001b[K\r\nStopping example_gitlab-cache_1 ... \u001b[32mdone\u001b[39m\u001b[K\r\n$\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:bash*Z 1:vi-                                                 \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[25;3H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[130.952235, "o", "docker-compose -f docker-compose.demo8.yml exec builder sh"]
[131.527428, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[132.062706, "o", "/ # "]
[132.063054, "o", "\u001b[?25l\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[25;5H\u001b[?12l\u001b[?25h"]
[132.063723, "o", "\r/ # \u001b[1;25r\u001b[25;5H\u001b[K\u001b[1;26r\u001b[25;5H"]
[132.633339, "o", "\u001b[?25l\u001b[H\u001b[K\r\n## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh            "]
[132.633495, "o", "                             \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n                                                                                  218,1         99%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[19;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[133.487777, "o", "\u001b[1;24r\u001b[24;1H\n\u001b[25;83H\u001b[K219,1\u001b[9C99%\u001b[1;26r\u001b[19;1H"]
[134.521087, "o", "\u001b[?25l\u001b[H## 8 - Gitlab with DNS and TLS Injection                                                       \u001b[30m\u001b[43m[0/0]\u001b[39m\u001b[49m\u001b[2;1H\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                      "]
[134.521407, "o", " \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n                                                                                  219,1         99%\u001b[K\u001b[19;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[134.523335, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:[tmux]*                                   \"bmitch-t490\" 18:11 10-May-20\u001b(B\u001b[m\u001b[19;1H\u001b[?12l\u001b[?25h"]
[135.743786, "o", "\u001b[30m\u001b[43md\u001b[?25l\u001b[26;1H\u001b[42m[preso] 0:docker-compose-Z 1:[tmux]*                                   \"bmitch-t490\" 18:12 10-May-20\u001b(B\u001b[m\u001b[19;1H\u001b[?12l\u001b[?25h"]
[136.15147, "o", "\u001b[30m\u001b[43mdocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                       \u001b[20;1He\r\u001b(B\u001b[m"]
[137.647453, "o", "\u001b[A\u001b[30m\u001b[43md\u001b[39m\u001b[49mocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                       \u001b[20;1He\u001b[19;1H\u001b[30m\u001b[43mdocker image pull registry.gitlab.com/sudo-bmitch/demo:debian \b\u001b(B\u001b[m"]
[138.167491, "o", "\r\u001b[30m\u001b[43mdocker image pull registry.gitlab.com/sudo-bmitch/demo:debian\u001b[39m\u001b[49m \b\b"]
[138.620194, "o", "\u001b]52;;ZG9ja2VyIGltYWdlIHB1bGwgcmVnaXN0cnkuZ2l0bGFiLmNvbS9zdWRvLWJtaXRjaC9kZW1vOmRlYmlhbg==\u0007\r\u001b[?1006h\u001b[?1000h"]
[138.621272, "o", "\u001b[?25l\u001b[H## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                 "]
[138.621439, "o", "                        \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n                                                                                  219,1         99%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:12 10-May-20\u001b(B\u001b[m\u001b[19;1H\u001b[?12l\u001b[?25h"]
[139.233296, "o", "\u001b[?25l\u001b[H\u001b[K\r\nexample_hub-cache_1 is up-to-date\u001b[K\r\nRecreating example_builder_1      ... \u001b[32mdone\u001b[39m\u001b[K\r\nRecreating example_gitlab-cache_1 ... \u001b[32mdone\u001b[39m\u001b[K\r\n$ docker-compose -f docker-compose.demo8.yml exec builder sh                                       \u001b[K\r\n/ # docker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                  \u001b[K\r\ndebian: Pulling from sudo-bmitch/demo\u001b[K\r\nDigest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16                    \u001b[K\r\nStatus: Image is up to date for registry.gitlab.com/sudo-bmitch/demo:debian                        \u001b[K\r\nregistry.gitlab.com/sudo-bmitch/demo:debian\u001b[K\r\n/ # docker image push registry.gitlab.com/sudo-bmitch/demo:debian                                  \u001b[K\r\nThe push refers to repository [registry.gitlab.com/sudo-bmitch/demo]                               \u001b[K\r\ne40d297cf5f8: Layer already exists\u001b[K\r\n[DEPRECATION NOTICE] registry v2 schema1 support will be removed in an upcoming release. Please contact a"]
[139.233403, "o", "dmins of the registry.gitlab.com registry NOW to avoid future disruption. More information at https://docs.docker.com/registry/spec/deprecated-schema-v1/                                         \u001b[K\r\nerrors:\u001b[K\r\ndenied: requested access to the resource is denied                                                 \u001b[K\r\nunauthorized: authentication required\u001b[K\r\n\u001b[K\r\n/ # exit\u001b[K\r\n$ docker-compose -f docker-compose.demo8.yml stop gitlab-cache                                     \u001b[K\r\nStopping example_gitlab-cache_1 ... \u001b[32mdone\u001b[39m\u001b[K\r\n$ docker-compose -f docker-compose.demo8.yml exec builder sh                                       \u001b[K\r\n/ #\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:12 10-May-20\u001b(B\u001b[m\u001b[25;5H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[140.352649, "o", "docker image pull registry.gitlab.com/sudo-b"]
[140.352942, "o", "mitch/demo:debian"]
[141.572224, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[142.042583, "o", "\u001b[1;25r\u001b[3S\u001b[22ddebian: Pulling from sudo-bmitch/demo\r\nDigest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16\r\nStatus: Image is up to date for registry.gitlab.com/sudo-bmitch/demo:debian\u001b[1;26r\u001b[25;1H"]
[142.043162, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[Aregistry.gitlab.com/sudo-bmitch/demo:debian\u001b[1;26r\u001b[25;1H"]
[142.046722, "o", "/ # "]
[143.84985, "o", "\u001b[?25l\u001b[H## 8 - Gitlab with DNS and TLS Injection\u001b[K\r\n\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                 "]
[143.850162, "o", "                        \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n                                                                                  219,1         99%\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:12 10-May-20\u001b(B\u001b[m\u001b[19;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
[144.656001, "o", "\u001b[1;24r\u001b[24;1H\n\u001b[25;83H\u001b[K220,1\u001b[9CBot\u001b[1;26r\u001b[19;1H"]
[147.185362, "o", "\u001b[?25l\u001b[H                                                                                               \u001b[30m\u001b[43m[0/0]\u001b[2;1H\u001b[49m\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndock"]
[147.185696, "o", "er-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n                                                                                  220,1         Bot\u001b[K\u001b[19;1H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[147.186766, "o", "\u001b[?25l\u001b[26d\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:[tmux]*                                   \"bmitch-t490\" 18:12 10-May-20\u001b(B\u001b[m\u001b[19;1H\u001b[?12l\u001b[?25h"]
[147.671578, "o", "\u001b[30m\u001b[43me\r\u001b(B\u001b[m"]
[147.93555, "o", "\u001b[30m\u001b[43mecho \"$GITLAB_TOKEN\" | docker login -u \"$GITLAB_USER\" --password-stdin registry.gitlab.com          \u001b[20;1Hd\r\u001b(B\u001b[m"]
[148.381325, "o", "\u001b[30m\u001b[43mdocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                       \u001b[21;1He\r\u001b(B\u001b[m"]
[149.080252, "o", "\u001b[A\u001b[30m\u001b[43md\u001b[39m\u001b[49mocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                       \u001b[21;1He\u001b[20;1H\u001b[30m\u001b[43mdocker image push registry.gitlab.com/sudo-bmitch/demo:debian \b\u001b(B\u001b[m"]
[149.279583, "o", "\r\u001b[30m\u001b[43mdocker image push registry.gitlab.com/sudo-bmitch/demo:debian\u001b[39m\u001b[49m \b\b"]
[150.279207, "o", "\u001b]52;;ZWNobyAiJEdJVExBQl9UT0tFTiIgfCBkb2NrZXIgbG9naW4gLXUgIiRHSVRMQUJfVVNFUiIgLS1wYXNzd29yZC1zdGRpbiByZWdpc3RyeS5naXRsYWIuY29tCmRvY2tlciBpbWFnZSBwdXNoIHJlZ2lzdHJ5LmdpdGxhYi5jb20vc3Vkby1ibWl0Y2gvZGVtbzpkZWJpYW4=\u0007\u001b[19;1H\u001b[?1006h\u001b[?1000h"]
[150.281515, "o", "\u001b[?25l\u001b[H\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\ndocker image pul"]
[150.281643, "o", "l registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n                                                                                  220,1         Bot\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:12 10-May-20\u001b(B\u001b[m\u001b[19;1H\u001b[?12l\u001b[?25h"]
[151.105153, "o", "\u001b[?25l\u001b[H/ # docker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                  \u001b[K\r\ndebian: Pulling from sudo-bmitch/demo\u001b[K\r\nDigest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16                    \u001b[K\r\nStatus: Image is up to date for registry.gitlab.com/sudo-bmitch/demo:debian                        \u001b[K\r\nregistry.gitlab.com/sudo-bmitch/demo:debian\u001b[K\r\n/ # docker image push registry.gitlab.com/sudo-bmitch/demo:debian                                  \u001b[K\r\nThe push refers to repository [registry.gitlab.com/sudo-bmitch/demo]                               \u001b[K\r\ne40d297cf5f8: Layer already exists\u001b[K\r\n[DEPRECATION NOTICE] registry v2 schema1 support will be removed in an upcoming release. Please contact admins of the registry.gitlab.com registry NOW to avoid future disruption. More information at https://docs.docker.com/registry/spec/deprecated-schema-v1/                                         \u001b[K\r\nerrors:\u001b[K\r\ndenied: requested access to the resource is denied"]
[151.10526, "o", "                                                 \u001b[K\r\nunauthorized: authentication required\u001b[K\r\n\u001b[K\r\n/ # exit\u001b[K\r\n$ docker-compose -f docker-compose.demo8.yml stop gitlab-cache                                     \u001b[K\r\nStopping example_gitlab-cache_1 ... \u001b[32mdone\u001b[39m\u001b[K\r\n$ docker-compose -f docker-compose.demo8.yml exec builder sh                                       \u001b[K\r\n/ # docker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                  \u001b[K\r\ndebian: Pulling from sudo-bmitch/demo\u001b[K\r\nDigest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16                    \u001b[K\r\nStatus: Image is up to date for registry.gitlab.com/sudo-bmitch/demo:debian                        \u001b[K\r\nregistry.gitlab.com/sudo-bmitch/demo:debian\u001b[K\r\n/ #\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose*Z 1:vi-                                       \"bmitch-t490\" 18:12 10-May-20\u001b(B\u001b[m\u001b[25;5H\u001b[?12l\u001b[?25h\u001b[?1000l\u001b[?1006l"]
[152.236819, "o", "echo \"$GITLAB_TOKEN\" | docker login -u \"$GITLAB_USER\" --password-stdi"]
[152.236974, "o", "n registry.gitlab\u001b[1;25r\u001b[25;1H\n\u001b[24;91H.com\u001b[1;26r\u001b[25;1H"]
[152.686379, "o", "\u001b[1;25r\u001b[4S\u001b[21dWARNING! Your password will be stored unencrypted in /root/.docker/config.json.\r\nConfigure a credential helper to remove this warning. See\r\nhttps://docs.docker.com/engine/reference/commandline/login/#credentials-store\u001b[1;26r\u001b[25;1H"]
[152.686932, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[ALogin Succeeded\u001b[1;26r\u001b[25;1H"]
[152.690421, "o", "/ # docker image push registr"]
[152.69076, "o", "y.gitlab.com/sudo-bmitch/demo:debian"]
[154.063972, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[1;26r\u001b[25;1H"]
[154.091865, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[AThe push refers to repository [registry.gitlab.com/sudo-bmitch/demo]\u001b[1;26r\u001b[25;1H"]
[154.195749, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[Ae40d297cf5f8: Preparing \u001b[1;26r\u001b[25;1H"]
[154.550329, "o", "\u001b[A\u001b[Ke40d297cf5f8: Layer already exists \r\n"]
[155.657843, "o", "\u001b[1;25r\u001b[25;1H\n\u001b[Adebian: digest: sha256:b1feef0e231d159a8d9d9524ac507f2488e34d032421368830efb08ad5038f16 size: 529\u001b[1;26r\u001b[25;1H"]
[155.661458, "o", "/ # "]
[159.256654, "o", "\u001b[?25l\u001b[H\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m update certs for registry.gitlab.com\u001b(B\u001b[m\u001b[K\r\nmore make-certs.demo8.sh\u001b[K\r\n./make-certs.demo8.sh\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m show change to DNS/TLS certs\u001b(B\u001b[m\u001b[K\r\nmore docker-compose.demo8.yml\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml up -d\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m we can pull through the intercepted name\u001b(B\u001b[m\u001b[K\r\ndocker image pull registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m however we can't push\u001b(B\u001b[m\u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m#\u001b[35m verify it still works when cache is down\u001b(B\u001b[m\u001b[K\r\ndocker-compose -f docker-compose.demo8.yml stop gitlab-cache                                       \u001b[K\r\ndocker-compose -f docker-compose.demo8.yml exec builder sh                                         \u001b[K\r\ndocker image pul"]
[159.256977, "o", "l registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\necho \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mTOKEN\" | docker login -u \"$GITLAB\u001b[37m\u001b[41m\u001b[1m_\u001b(B\u001b[mUSER\" --password-stdin registry.gitlab.com         \u001b[K\r\ndocker image push registry.gitlab.com/sudo-bmitch/demo:debian                                      \u001b[K\r\nexit\u001b[K\r\n\u001b[31m\u001b[1m```\u001b(B\u001b[m\u001b[K\r\n\u001b[K\r\n\u001b[K\r\n                                                                                  220,1         Bot\u001b[K\r\n\u001b[30m\u001b[42m[preso] 0:docker-compose-Z 1:vi*                                       \"bmitch-t490\" 18:12 10-May-20\u001b(B\u001b[m\u001b[19;1H\u001b[?12l\u001b[?25h\u001b[?1006h\u001b[?1000h"]
